---
title: "❌ Test Result 2021-09-16 16:13 UTC"
date: 2021-09-16T16:13:37.462516328+00:00
categories: test-report
---


| | Total | Passed | Failed | Ignored | Filtered | Duration |
| --- | ----- | -------| ------ | ------- | -------- | -------- |
| ❌ | 51 | 35 | 16 | 0 | 0 | 1208.647838734s |


**Job:** https://github.com/drogue-iot/drogue-cloud-testing/actions/runs/1242153440


# Index

| Name | Result | Duration |
| ---- | ------ | -------- |
| [init::web::test::test_web_destroy](#initwebtesttest_web_destroy) | ✅ | 6.025529838s | 
| [init::web::test::test_web_test](#initwebtesttest_web_test) | ✅ | 6.330692838s | 
| [tests::coap::command::test_command::version_1](#testscoapcommandtest_commandversion_1) | ❌ | 50.201211709s | 
| [tests::coap::command::test_command::version_2](#testscoapcommandtest_commandversion_2) | ❌ | 52.005656199s | 
| [tests::coap::command::test_command::version_3](#testscoapcommandtest_commandversion_3) | ❌ | 50.911672903s | 
| [tests::coap::telemetry::test_send_telemetry_pass::version_1](#testscoaptelemetrytest_send_telemetry_passversion_1) | ❌ | 50.799131124s | 
| [tests::coap::telemetry::test_send_telemetry_pass::version_2](#testscoaptelemetrytest_send_telemetry_passversion_2) | ❌ | 49.050912649s | 
| [tests::coap::telemetry::test_send_telemetry_pass::version_3](#testscoaptelemetrytest_send_telemetry_passversion_3) | ❌ | 49.150559331s | 
| [tests::coap::telemetry::test_send_telemetry_user::version_1](#testscoaptelemetrytest_send_telemetry_userversion_1) | ❌ | 52.087715086s | 
| [tests::coap::telemetry::test_send_telemetry_user::version_2](#testscoaptelemetrytest_send_telemetry_userversion_2) | ❌ | 51.095604543s | 
| [tests::coap::telemetry::test_send_telemetry_user::version_3](#testscoaptelemetrytest_send_telemetry_userversion_3) | ❌ | 52.425933547s | 
| [tests::coap::telemetry::test_send_telemetry_user_alias::version_1](#testscoaptelemetrytest_send_telemetry_user_aliasversion_1) | ❌ | 49.858782735s | 
| [tests::coap::telemetry::test_send_telemetry_user_alias::version_2](#testscoaptelemetrytest_send_telemetry_user_aliasversion_2) | ❌ | 49.051480669s | 
| [tests::coap::telemetry::test_send_telemetry_user_alias::version_3](#testscoaptelemetrytest_send_telemetry_user_aliasversion_3) | ❌ | 50.696858724s | 
| [tests::coap::telemetry::test_send_telemetry_user_only::version_1](#testscoaptelemetrytest_send_telemetry_user_onlyversion_1) | ❌ | 49.55929897s | 
| [tests::coap::telemetry::test_send_telemetry_user_only::version_2](#testscoaptelemetrytest_send_telemetry_user_onlyversion_2) | ❌ | 48.740237925s | 
| [tests::coap::telemetry::test_send_telemetry_user_only::version_3](#testscoaptelemetrytest_send_telemetry_user_onlyversion_3) | ❌ | 49.053485973s | 
| [tests::drg::test_drg_version](#testsdrgtest_drg_version) | ✅ | 7.65782687s | 
| [tests::http::command::test_command::version_1](#testshttpcommandtest_commandversion_1) | ✅ | 15.765888365s | 
| [tests::http::command::test_command::version_2](#testshttpcommandtest_commandversion_2) | ✅ | 14.080653883s | 
| [tests::http::command::test_command::version_3](#testshttpcommandtest_commandversion_3) | ✅ | 15.018258174s | 
| [tests::http::telemetry::test_send_telemetry_pass::version_1](#testshttptelemetrytest_send_telemetry_passversion_1) | ✅ | 14.227111479s | 
| [tests::http::telemetry::test_send_telemetry_pass::version_2](#testshttptelemetrytest_send_telemetry_passversion_2) | ✅ | 14.670344829s | 
| [tests::http::telemetry::test_send_telemetry_pass::version_3](#testshttptelemetrytest_send_telemetry_passversion_3) | ✅ | 13.233156176s | 
| [tests::http::telemetry::test_send_telemetry_user::version_1](#testshttptelemetrytest_send_telemetry_userversion_1) | ✅ | 13.761483042s | 
| [tests::http::telemetry::test_send_telemetry_user::version_2](#testshttptelemetrytest_send_telemetry_userversion_2) | ✅ | 15.148632247s | 
| [tests::http::telemetry::test_send_telemetry_user::version_3](#testshttptelemetrytest_send_telemetry_userversion_3) | ✅ | 13.883565511s | 
| [tests::http::telemetry::test_send_telemetry_user_alias::version_1](#testshttptelemetrytest_send_telemetry_user_aliasversion_1) | ✅ | 15.149462025s | 
| [tests::http::telemetry::test_send_telemetry_user_alias::version_2](#testshttptelemetrytest_send_telemetry_user_aliasversion_2) | ✅ | 13.968707673s | 
| [tests::http::telemetry::test_send_telemetry_user_alias::version_3](#testshttptelemetrytest_send_telemetry_user_aliasversion_3) | ✅ | 13.050530705s | 
| [tests::http::telemetry::test_send_telemetry_user_only::version_1](#testshttptelemetrytest_send_telemetry_user_onlyversion_1) | ✅ | 13.987304678s | 
| [tests::http::telemetry::test_send_telemetry_user_only::version_2](#testshttptelemetrytest_send_telemetry_user_onlyversion_2) | ✅ | 14.983486302s | 
| [tests::http::telemetry::test_send_telemetry_user_only::version_3](#testshttptelemetrytest_send_telemetry_user_onlyversion_3) | ✅ | 13.904948245s | 
| [tests::mqtt::command::test_command::version_1](#testsmqttcommandtest_commandversion_1) | ✅ | 9.495746283s | 
| [tests::mqtt::command::test_command::version_2](#testsmqttcommandtest_commandversion_2) | ✅ | 9.306200889s | 
| [tests::mqtt::command::test_command::version_3](#testsmqttcommandtest_commandversion_3) | ✅ | 8.503660664s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_1](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_1integration_version_1) | ✅ | 15.456891997s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_2](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_1integration_version_2) | ✅ | 15.98472069s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_3](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_1integration_version_3) | ✅ | 15.044858559s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_1](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_2integration_version_1) | ✅ | 15.193079643s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_2](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_2integration_version_2) | ✅ | 15.034567951s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_3](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_2integration_version_3) | ✅ | 15.016176911s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_1](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_3integration_version_1) | ✅ | 13.995606868s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_2](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_3integration_version_2) | ✅ | 15.114995059s | 
| [tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_3](#testsmqtttelemetrytest_send_telemetry_passendpoint_version_3integration_version_3) | ✅ | 14.94636917s | 
| [tests::registry::test_registry_create_and_delete](#testsregistrytest_registry_create_and_delete) | ❌ | 9.157882722s | 
| [tests::registry::test_registry_create_app](#testsregistrytest_registry_create_app) | ✅ | 9.070406528s | 
| [tests::registry::test_registry_create_app_and_device](#testsregistrytest_registry_create_app_and_device) | ✅ | 10.336797239s | 
| [tests::registry::test_registry_create_app_and_device_twice](#testsregistrytest_registry_create_app_and_device_twice) | ✅ | 9.148875362s | 
| [tests::registry::test_registry_create_app_twice](#testsregistrytest_registry_create_app_twice) | ✅ | 9.383276868s | 
| [tests::registry::test_registry_device_create_and_delete](#testsregistrytest_registry_device_create_and_delete) | ✅ | 8.909697586s | 


# Details

## ✅ init::web::test::test_web_destroy

**Duration**: 6.025529838s

## ✅ init::web::test::test_web_test

**Duration**: 6.330692838s

## ❌ tests::coap::command::test_command::version_1

**Duration**: 50.201211709s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:53:41Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk0MjYsImlhdCI6MTYzMTgwNzYyNiwianRpIjoiY2M4NDZmZWMtNDA1ZC00MjZjLTkyZjAtYjFhYTY2MGIyYjM3IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjdmYjZiOWI5LTAwNmItNGNhOS04ZTAwLWM2NDZjYjI3ZGY4YyJ9.RfZjBx_S5Xh1cTeK67Yg36Wo7LcNR7zWuMqou2dmBNI
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(256)), stdout: "", stderr: "Error: Error loading config file\n\nCaused by:\n    0: Unable to open configuration file. Did you log into a drogue cloud cluster ?\n    1: No such file or directory (os error 2)\n" })
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk0MjYsImlhdCI6MTYzMTgwNzYyNiwianRpIjoiY2M4NDZmZWMtNDA1ZC00MjZjLTkyZjAtYjFhYTY2MGIyYjM3IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjdmYjZiOWI5LTAwNmItNGNhOS04ZTAwLWM2NDZjYjI3ZGY4YyJ9.RfZjBx_S5Xh1cTeK67Yg36Wo7LcNR7zWuMqou2dmBNI" "--context" "system-tests"
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDc5MjcsImlhdCI6MTYzMTgwNzYyNywiYXV0aF90aW1lIjoxNjMxODA3NjI0LCJqdGkiOiI4YmMxMmUxOS1jZjg3LTRhOWItYWI5MC1hM2MyNjgxZWM0ZGYiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiYWNjb3VudCJdLCJzdWIiOiIxMjEwZjNhYy03NmMyLTRkMjQtYmM4MC1hYTAxYTcyNDczNzAiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vY29uc29sZS4xNzIuMTguMC4yLm5pcC5pbyIsImh0dHA6Ly9sb2NhbGhvc3Q6KiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZHJvZ3VlLXVzZXIiLCJkcm9ndWUtYWRtaW4iLCJvZmZsaW5lX2FjY2VzcyJdfSwicmVzb3VyY2VfYWNjZXNzIjp7InJlYWxtLW1hbmFnZW1lbnQiOnsicm9sZXMiOlsibWFuYWdlLXVzZXJzIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwic2lkIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiU3lzdGVtIEFkbWluIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJnaXZlbl9uYW1lIjoiU3lzdGVtIiwiZmFtaWx5X25hbWUiOiJBZG1pbiIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.MZdB-FwcGWbNlOaIZvwYjuHTU1A7ZsdqwjsRVXoryNSHkJvbPhpfeLUGCXnSAmxX5xp2I-nEgXohCLysUR1b6s314zqH1xe-9dUI_Db-TFmz5j2E-ij5ZGjrgwFxOP3-Ncjk2i45JK-H6jND6KmAFwMziySy28iADoP_zHpAVytifxn1E6X9gnpHB-V2n6TwRB0DcbXqepysrOav-GbDByo-DrjcejKgiq4_JEdtmYL5MPdLfmdckIqWTNw05xzkIpl1FpaL5cgPXkqf5nGrFzqXp_o3ipKLBYbRlJVZpnRZsG1x-9LuSGyx3jCRKFoZcE3tMtLNxRgCclT2_gAguA\n", stderr: "" })
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::resources::apps] Create application: 67930864-dd30-40d2-90b4-0484ea8ebd26
[2021-09-16T15:53:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "67930864-dd30-40d2-90b4-0484ea8ebd26"
[2021-09-16T15:53:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 67930864-dd30-40d2-90b4-0484ea8ebd26 created.\n", stderr: "" })
[2021-09-16T15:53:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "67930864-dd30-40d2-90b4-0484ea8ebd26"
[2021-09-16T15:53:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:53:47.944826Z\",\n    \"generation\": 0,\n    \"name\": \"67930864-dd30-40d2-90b4-0484ea8ebd26\",\n    \"resourceVersion\": \"6146a384-0e5f-4cfc-9c56-e7f7a0d207af\",\n    \"uid\": \"78e05812-b287-4599-bf70-ef315ef3228d\"\n  }\n}", stderr: "" })
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "67930864-dd30-40d2-90b4-0484ea8ebd26"
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:53:47.944826Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"67930864-dd30-40d2-90b4-0484ea8ebd26\",\n    \"resourceVersion\": \"ca386e6d-a539-411d-99f4-a3e5cf5ffba7\",\n    \"uid\": \"78e05812-b287-4599-bf70-ef315ef3228d\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:53:49.003747888Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:53:49.003780378Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.531175409Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.554053992Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.753831596Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.763955609Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:49.003718223Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:49.003720097Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"an9BYo98DwXR\",\n        \"username\": \"user-67930864-dd30-40d2-90b4-0484ea8ebd26\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "67930864-dd30-40d2-90b4-0484ea8ebd26"
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:53:47.944826Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"67930864-dd30-40d2-90b4-0484ea8ebd26\",\n    \"resourceVersion\": \"ca386e6d-a539-411d-99f4-a3e5cf5ffba7\",\n    \"uid\": \"78e05812-b287-4599-bf70-ef315ef3228d\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:53:49.003747888Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:53:49.003780378Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.531175409Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.554053992Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.753831596Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:48.763955609Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:49.003718223Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:53:49.003720097Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"an9BYo98DwXR\",\n        \"username\": \"user-67930864-dd30-40d2-90b4-0484ea8ebd26\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "67930864-dd30-40d2-90b4-0484ea8ebd26" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::tests::coap::command] Sending payload
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::tests::coap::command] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDc5MjcsImlhdCI6MTYzMTgwNzYyNywiYXV0aF90aW1lIjoxNjMxODA3NjI0LCJqdGkiOiI4YmMxMmUxOS1jZjg3LTRhOWItYWI5MC1hM2MyNjgxZWM0ZGYiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiYWNjb3VudCJdLCJzdWIiOiIxMjEwZjNhYy03NmMyLTRkMjQtYmM4MC1hYTAxYTcyNDczNzAiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vY29uc29sZS4xNzIuMTguMC4yLm5pcC5pbyIsImh0dHA6Ly9sb2NhbGhvc3Q6KiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZHJvZ3VlLXVzZXIiLCJkcm9ndWUtYWRtaW4iLCJvZmZsaW5lX2FjY2VzcyJdfSwicmVzb3VyY2VfYWNjZXNzIjp7InJlYWxtLW1hbmFnZW1lbnQiOnsicm9sZXMiOlsibWFuYWdlLXVzZXJzIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwic2lkIjoiN2ZiNmI5YjktMDA2Yi00Y2E5LThlMDAtYzY0NmNiMjdkZjhjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiU3lzdGVtIEFkbWluIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJnaXZlbl9uYW1lIjoiU3lzdGVtIiwiZmFtaWx5X25hbWUiOiJBZG1pbiIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.MZdB-FwcGWbNlOaIZvwYjuHTU1A7ZsdqwjsRVXoryNSHkJvbPhpfeLUGCXnSAmxX5xp2I-nEgXohCLysUR1b6s314zqH1xe-9dUI_Db-TFmz5j2E-ij5ZGjrgwFxOP3-Ncjk2i45JK-H6jND6KmAFwMziySy28iADoP_zHpAVytifxn1E6X9gnpHB-V2n6TwRB0DcbXqepysrOav-GbDByo-DrjcejKgiq4_JEdtmYL5MPdLfmdckIqWTNw05xzkIpl1FpaL5cgPXkqf5nGrFzqXp_o3ipKLBYbRlJVZpnRZsG1x-9LuSGyx3jCRKFoZcE3tMtLNxRgCclT2_gAguA\n", stderr: "" })
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:53:49Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:53:50Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:53:50Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:53:52Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:53:52Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:53:53Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:53:53Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:53:53Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0078015b80, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/67930864-dd30-40d2-90b4-0484ea8ebd26", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 98, 102, 98, 97, 48, 97, 54, 53, 45, 51, 57, 48, 51, 45, 52, 50, 49, 48, 45, 56, 98, 50, 50, 45, 56, 55, 97, 51, 57, 97, 101, 54, 55, 53, 52, 52, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 54, 55, 57, 51, 48, 56, 54, 52, 37, 50, 68, 100, 100, 51, 48, 37, 50, 68, 52, 48, 100, 50, 37, 50, 68, 57, 48, 98, 52, 37, 50, 68, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 51, 58, 53, 51, 46, 48, 54, 56, 53, 56, 53, 52, 55, 57, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 54, 55, 57, 51, 48, 56, 54, 52, 37, 50, 68, 100, 100, 51, 48, 37, 50, 68, 52, 48, 100, 50, 37, 50, 68, 57, 48, 98, 52, 37, 50, 68, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 54, 55, 57, 51, 48, 56, 54, 52, 45, 100, 100, 51, 48, 45, 52, 48, 100, 50, 45, 57, 48, 98, 52, 45, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T15:53:53Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/67930864-dd30-40d2-90b4-0484ea8ebd26", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"bfba0a65-3903-4210-8b22-87a39ae67544\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://67930864%2Ddd30%2D40d2%2D90b4%2D0484ea8ebd26/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:53:53.068585479Z\",\"data\":{\"index\":3},\"partitionkey\":\"67930864%2Ddd30%2D40d2%2D90b4%2D0484ea8ebd26/device1\",\"application\":\"67930864-dd30-40d2-90b4-0484ea8ebd26\",\"instance\":\"drogue\",\"device\":\"device1\"}" }
[2021-09-16T15:53:54Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T15:53:54Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    99,
                    116,
                    61,
                    54,
                    48,
                    48,
                    48,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    65,
                    50,
                    78,
                    122,
                    107,
                    122,
                    77,
                    68,
                    103,
                    50,
                    78,
                    67,
                    49,
                    107,
                    90,
                    68,
                    77,
                    119,
                    76,
                    84,
                    81,
                    119,
                    90,
                    68,
                    73,
                    116,
                    79,
                    84,
                    66,
                    105,
                    78,
                    67,
                    48,
                    119,
                    78,
                    68,
                    103,
                    48,
                    90,
                    87,
                    69,
                    52,
                    90,
                    87,
                    74,
                    107,
                    77,
                    106,
                    89,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
[2021-09-16T15:53:54Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 452, payload: 0x7f0078015da0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/67930864-dd30-40d2-90b4-0484ea8ebd26", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 99, 54, 51, 52, 99, 55, 56, 55, 45, 57, 57, 49, 51, 45, 52, 57, 98, 52, 45, 56, 101, 57, 49, 45, 98, 51, 53, 100, 57, 48, 100, 50, 101, 56, 102, 99, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 54, 55, 57, 51, 48, 56, 54, 52, 37, 50, 68, 100, 100, 51, 48, 37, 50, 68, 52, 48, 100, 50, 37, 50, 68, 57, 48, 98, 52, 37, 50, 68, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 111, 99, 116, 101, 116, 45, 115, 116, 114, 101, 97, 109, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 116, 101, 108, 101, 109, 101, 116, 114, 121, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 51, 58, 53, 52, 46, 49, 54, 55, 48, 55, 51, 50, 48, 52, 90, 34, 44, 34, 100, 97, 116, 97, 95, 98, 97, 115, 101, 54, 52, 34, 58, 34, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 54, 55, 57, 51, 48, 56, 54, 52, 37, 50, 68, 100, 100, 51, 48, 37, 50, 68, 52, 48, 100, 50, 37, 50, 68, 57, 48, 98, 52, 37, 50, 68, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 54, 55, 57, 51, 48, 56, 54, 52, 45, 100, 100, 51, 48, 45, 52, 48, 100, 50, 45, 57, 48, 98, 52, 45, 48, 52, 56, 52, 101, 97, 56, 101, 98, 100, 50, 54, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T15:53:54Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/67930864-dd30-40d2-90b4-0484ea8ebd26", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"c634c787-9913-49b4-8e91-b35d90d2e8fc\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://67930864%2Ddd30%2D40d2%2D90b4%2D0484ea8ebd26/device1\",\"datacontenttype\":\"application/octet-stream\",\"subject\":\"telemetry\",\"time\":\"2021-09-16T15:53:54.167073204Z\",\"data_base64\":\"\",\"device\":\"device1\",\"instance\":\"drogue\",\"partitionkey\":\"67930864%2Ddd30%2D40d2%2D90b4%2D0484ea8ebd26/device1\",\"application\":\"67930864-dd30-40d2-90b4-0484ea8ebd26\"}" }
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:54:29Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "67930864-dd30-40d2-90b4-0484ea8ebd26" "device1"
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::resources::apps] Destroy application '67930864-dd30-40d2-90b4-0484ea8ebd26'
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "67930864-dd30-40d2-90b4-0484ea8ebd26"
[2021-09-16T15:54:29Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 67930864-dd30-40d2-90b4-0484ea8ebd26 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::command::test_command::version_2

**Duration**: 52.005656199s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:54:32Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk0NzYsImlhdCI6MTYzMTgwNzY3NiwianRpIjoiZmUzMzI2ZjItNzUxYy00ZDU4LWIxNjEtZTAwNmY0NzM1ZjAyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjYzZmQzZDdjLTUxMjctNDIzMC1iNTZlLThiZmY5NWZjYzUwZCJ9.VNRqGJ3NXAStD-pIf8XAgQ4hScXx8Z4hjl2Xm0OB4y8
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk0NzYsImlhdCI6MTYzMTgwNzY3NiwianRpIjoiZmUzMzI2ZjItNzUxYy00ZDU4LWIxNjEtZTAwNmY0NzM1ZjAyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjYzZmQzZDdjLTUxMjctNDIzMC1iNTZlLThiZmY5NWZjYzUwZCJ9.VNRqGJ3NXAStD-pIf8XAgQ4hScXx8Z4hjl2Xm0OB4y8" "--context" "system-tests"
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDc5NzcsImlhdCI6MTYzMTgwNzY3NywiYXV0aF90aW1lIjoxNjMxODA3Njc0LCJqdGkiOiIwODk4YTVjYy00NWU5LTRiMTYtOWJiYy1iZmFiNWI4OTdmZDgiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiYWNjb3VudCJdLCJzdWIiOiIxMjEwZjNhYy03NmMyLTRkMjQtYmM4MC1hYTAxYTcyNDczNzAiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vY29uc29sZS4xNzIuMTguMC4yLm5pcC5pbyIsImh0dHA6Ly9sb2NhbGhvc3Q6KiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZHJvZ3VlLXVzZXIiLCJkcm9ndWUtYWRtaW4iLCJvZmZsaW5lX2FjY2VzcyJdfSwicmVzb3VyY2VfYWNjZXNzIjp7InJlYWxtLW1hbmFnZW1lbnQiOnsicm9sZXMiOlsibWFuYWdlLXVzZXJzIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwic2lkIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiU3lzdGVtIEFkbWluIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJnaXZlbl9uYW1lIjoiU3lzdGVtIiwiZmFtaWx5X25hbWUiOiJBZG1pbiIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.SGMzmUAlknESTVYr7KRh12g2Ea2enFtLVZjqE8EuojNnX27aooY66wvTYYwN6h_m3KOFd6oHquif-jKs-T4Xtz5t0tKg74CUDu-JlRszVKKu6gzJZgz15A6PTl0GuQVAx9NrAC9L1-frNXIluYeicHk4iPOnu-555iBf99GsqtzkdHtet4ZL-8wKNPJ9y_QY9XmAy8sDeGAwK5i0QnpGMVEI3VVOTb8UK0o8KDRrF1OQeonhmxlo3JbCEej1CNnnNILhRgIrr_rr2UewVmeK8WRDq6u5ij-hAgMk2eMRxEBUK_TxHXbbRvllYGTJzg9kQ-MidGutzRBc-wfiVDIPBQ\n", stderr: "" })
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::resources::apps] Create application: dc268140-92ad-482d-a350-8c6a9c0de051
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "dc268140-92ad-482d-a350-8c6a9c0de051"
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App dc268140-92ad-482d-a350-8c6a9c0de051 created.\n", stderr: "" })
[2021-09-16T15:54:37Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "dc268140-92ad-482d-a350-8c6a9c0de051"
[2021-09-16T15:54:38Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:54:37.960569Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"dc268140-92ad-482d-a350-8c6a9c0de051\",\n    \"resourceVersion\": \"8bcc86af-a17f-483e-b5a0-8171686c0415\",\n    \"uid\": \"3c0870db-cef1-465e-84b1-b2ff7f978262\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:37.987211843Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:37.987564691Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987178201Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987180606Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987181297Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987182308Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987182829Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:37.987185495Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "dc268140-92ad-482d-a350-8c6a9c0de051"
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:54:37.960569Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"dc268140-92ad-482d-a350-8c6a9c0de051\",\n    \"resourceVersion\": \"3169f659-54b1-4319-b724-c4d2edf03bc8\",\n    \"uid\": \"3c0870db-cef1-465e-84b1-b2ff7f978262\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:38.376355780Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:38.376394071Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.024134662Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.030915901Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.174404276Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.181667261Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.376321497Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.376323560Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"GRh0CwFgJ1r0\",\n        \"username\": \"user-dc268140-92ad-482d-a350-8c6a9c0de051\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "dc268140-92ad-482d-a350-8c6a9c0de051"
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:54:37.960569Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"dc268140-92ad-482d-a350-8c6a9c0de051\",\n    \"resourceVersion\": \"3169f659-54b1-4319-b724-c4d2edf03bc8\",\n    \"uid\": \"3c0870db-cef1-465e-84b1-b2ff7f978262\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:38.376355780Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:54:38.376394071Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.024134662Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.030915901Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.174404276Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.181667261Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.376321497Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:54:38.376323560Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"GRh0CwFgJ1r0\",\n        \"username\": \"user-dc268140-92ad-482d-a350-8c6a9c0de051\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "dc268140-92ad-482d-a350-8c6a9c0de051" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::tests::coap::command] Sending payload
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::tests::coap::command] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDc5NzcsImlhdCI6MTYzMTgwNzY3NywiYXV0aF90aW1lIjoxNjMxODA3Njc0LCJqdGkiOiIwODk4YTVjYy00NWU5LTRiMTYtOWJiYy1iZmFiNWI4OTdmZDgiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiYWNjb3VudCJdLCJzdWIiOiIxMjEwZjNhYy03NmMyLTRkMjQtYmM4MC1hYTAxYTcyNDczNzAiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vY29uc29sZS4xNzIuMTguMC4yLm5pcC5pbyIsImh0dHA6Ly9sb2NhbGhvc3Q6KiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZHJvZ3VlLXVzZXIiLCJkcm9ndWUtYWRtaW4iLCJvZmZsaW5lX2FjY2VzcyJdfSwicmVzb3VyY2VfYWNjZXNzIjp7InJlYWxtLW1hbmFnZW1lbnQiOnsicm9sZXMiOlsibWFuYWdlLXVzZXJzIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIiwic2lkIjoiNjNmZDNkN2MtNTEyNy00MjMwLWI1NmUtOGJmZjk1ZmNjNTBkIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiU3lzdGVtIEFkbWluIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJnaXZlbl9uYW1lIjoiU3lzdGVtIiwiZmFtaWx5X25hbWUiOiJBZG1pbiIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.SGMzmUAlknESTVYr7KRh12g2Ea2enFtLVZjqE8EuojNnX27aooY66wvTYYwN6h_m3KOFd6oHquif-jKs-T4Xtz5t0tKg74CUDu-JlRszVKKu6gzJZgz15A6PTl0GuQVAx9NrAC9L1-frNXIluYeicHk4iPOnu-555iBf99GsqtzkdHtet4ZL-8wKNPJ9y_QY9XmAy8sDeGAwK5i0QnpGMVEI3VVOTb8UK0o8KDRrF1OQeonhmxlo3JbCEej1CNnnNILhRgIrr_rr2UewVmeK8WRDq6u5ij-hAgMk2eMRxEBUK_TxHXbbRvllYGTJzg9kQ-MidGutzRBc-wfiVDIPBQ\n", stderr: "" })
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:39Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:54:41Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:41Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:54:42Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:42Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:54:43Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:43Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:54:44Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:54:44Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:54:44Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0080016c00, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } }, data: MessageData { topic: "app/dc268140-92ad-482d-a350-8c6a9c0de051", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 51, 55, 55, 56, 100, 98, 97, 97, 45, 98, 54, 52, 100, 45, 52, 54, 102, 97, 45, 56, 56, 98, 50, 45, 101, 48, 98, 52, 102, 53, 50, 57, 51, 53, 98, 54, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 100, 99, 50, 54, 56, 49, 52, 48, 37, 50, 68, 57, 50, 97, 100, 37, 50, 68, 52, 56, 50, 100, 37, 50, 68, 97, 51, 53, 48, 37, 50, 68, 56, 99, 54, 97, 57, 99, 48, 100, 101, 48, 53, 49, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 52, 58, 52, 52, 46, 49, 51, 50, 48, 53, 49, 51, 49, 49, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 100, 99, 50, 54, 56, 49, 52, 48, 37, 50, 68, 57, 50, 97, 100, 37, 50, 68, 52, 56, 50, 100, 37, 50, 68, 97, 51, 53, 48, 37, 50, 68, 56, 99, 54, 97, 57, 99, 48, 100, 101, 48, 53, 49, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 100, 99, 50, 54, 56, 49, 52, 48, 45, 57, 50, 97, 100, 45, 52, 56, 50, 100, 45, 97, 51, 53, 48, 45, 56, 99, 54, 97, 57, 99, 48, 100, 101, 48, 53, 49, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } } } }
[2021-09-16T15:54:44Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/dc268140-92ad-482d-a350-8c6a9c0de051", content_type: Some("application/cloudevents+json; charset=utf-8"), user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"3778dbaa-b64d-46fa-88b2-e0b4f52935b6\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://dc268140%2D92ad%2D482d%2Da350%2D8c6a9c0de051/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:54:44.132051311Z\",\"data\":{\"index\":4},\"partitionkey\":\"dc268140%2D92ad%2D482d%2Da350%2D8c6a9c0de051/device1\",\"application\":\"dc268140-92ad-482d-a350-8c6a9c0de051\",\"instance\":\"drogue\",\"device\":\"device1\"}" }
[2021-09-16T15:54:45Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T15:54:45Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    99,
                    116,
                    61,
                    54,
                    48,
                    48,
                    48,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    66,
                    107,
                    89,
                    122,
                    73,
                    50,
                    79,
                    68,
                    69,
                    48,
                    77,
                    67,
                    48,
                    53,
                    77,
                    109,
                    70,
                    107,
                    76,
                    84,
                    81,
                    52,
                    77,
                    109,
                    81,
                    116,
                    89,
                    84,
                    77,
                    49,
                    77,
                    67,
                    48,
                    52,
                    89,
                    122,
                    90,
                    104,
                    79,
                    87,
                    77,
                    119,
                    90,
                    71,
                    85,
                    119,
                    78,
                    84,
                    69,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:55:20Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:55:20Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "dc268140-92ad-482d-a350-8c6a9c0de051" "device1"
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::resources::apps] Destroy application 'dc268140-92ad-482d-a350-8c6a9c0de051'
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "dc268140-92ad-482d-a350-8c6a9c0de051"
[2021-09-16T15:55:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App dc268140-92ad-482d-a350-8c6a9c0de051 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::command::test_command::version_3

**Duration**: 50.911672903s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:55:24Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:55:29Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk1MjksImlhdCI6MTYzMTgwNzcyOSwianRpIjoiM2Q1MzZkNGQtMDhhMC00YzAyLWIwYTctNzZhNzM0OGIxMzkwIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZThmNGIxNDUtMTNmYi00YTg2LWFhYmUtNjNiYzMyMGVmZTQ4Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImU4ZjRiMTQ1LTEzZmItNGE4Ni1hYWJlLTYzYmMzMjBlZmU0OCJ9.K5HKPV8L3AyVLqOTKUQ0M4dq0tx8znGJ7w9_35QFisI
[2021-09-16T15:55:29Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:55:29Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:55:29Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk1MjksImlhdCI6MTYzMTgwNzcyOSwianRpIjoiM2Q1MzZkNGQtMDhhMC00YzAyLWIwYTctNzZhNzM0OGIxMzkwIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZThmNGIxNDUtMTNmYi00YTg2LWFhYmUtNjNiYzMyMGVmZTQ4Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImU4ZjRiMTQ1LTEzZmItNGE4Ni1hYWJlLTYzYmMzMjBlZmU0OCJ9.K5HKPV8L3AyVLqOTKUQ0M4dq0tx8znGJ7w9_35QFisI" "--context" "system-tests"
[2021-09-16T15:55:29Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgwMjksImlhdCI6MTYzMTgwNzcyOSwiYXV0aF90aW1lIjoxNjMxODA3NzI2LCJqdGkiOiIwOTNkMDk2OC0yNzg1LTQzNDYtOTk1NS0xODBjMDIyNWVkZWMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImU4ZjRiMTQ1LTEzZmItNGE4Ni1hYWJlLTYzYmMzMjBlZmU0OCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlOGY0YjE0NS0xM2ZiLTRhODYtYWFiZS02M2JjMzIwZWZlNDgiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.eAZhvqRtLPj3l0--Kg98Uatho1zicPsTm8Gp6Y0pub2v9f7Na0wX9uOg0dfPfgi88Ks9a7jsVhDSHNzFLvKWSz8mIUQZxselQXNmDq_s7_c8IXW0TqRtQiLXmSzm4Q8fp2-HUkIOTNur4URh92DMJhfBJLZVSlvjA45wmVVCop8k5kNa8hM6xVhu8Fn0BjIxPDlH1XAravfSiHudMCXwGrUf_zxuVHQsDCamojwisSPuqyq2Mlj6toDFJ7_BCVN-4D10ZoXosYGOYQ5M9WC0Ib9qXLVKtZAEMZj5ZjuB8KqikSqQjl3Qr024OK1U-K3DhiKDP-9WRuccnHwSbVCOXQ\n", stderr: "" })
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::resources::apps] Create application: 3963f4e4-3980-4cdc-a91c-4fb16462065e
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "3963f4e4-3980-4cdc-a91c-4fb16462065e"
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 3963f4e4-3980-4cdc-a91c-4fb16462065e created.\n", stderr: "" })
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "3963f4e4-3980-4cdc-a91c-4fb16462065e"
[2021-09-16T15:55:30Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:55:30.200982Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"3963f4e4-3980-4cdc-a91c-4fb16462065e\",\n    \"resourceVersion\": \"a64e61f4-82be-4dc2-aa01-d4be058e286a\",\n    \"uid\": \"19ded27e-2019-42eb-9789-4e1173c40e31\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.224320107Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.224339343Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224281606Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224284672Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224285423Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224286495Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224287036Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.224291294Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "3963f4e4-3980-4cdc-a91c-4fb16462065e"
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:55:30.200982Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"3963f4e4-3980-4cdc-a91c-4fb16462065e\",\n    \"resourceVersion\": \"c2d9b7e9-5261-4569-a32b-92519f656b5a\",\n    \"uid\": \"19ded27e-2019-42eb-9789-4e1173c40e31\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.641405602Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.641441078Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.271366427Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.279649207Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.438103617Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.462109116Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.641378082Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.641380407Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"QSv2Ni9B3QwO\",\n        \"username\": \"user-3963f4e4-3980-4cdc-a91c-4fb16462065e\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "3963f4e4-3980-4cdc-a91c-4fb16462065e"
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:55:30.200982Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"3963f4e4-3980-4cdc-a91c-4fb16462065e\",\n    \"resourceVersion\": \"c2d9b7e9-5261-4569-a32b-92519f656b5a\",\n    \"uid\": \"19ded27e-2019-42eb-9789-4e1173c40e31\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.641405602Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:55:30.641441078Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.271366427Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.279649207Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.438103617Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.462109116Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.641378082Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:55:30.641380407Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"QSv2Ni9B3QwO\",\n        \"username\": \"user-3963f4e4-3980-4cdc-a91c-4fb16462065e\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "3963f4e4-3980-4cdc-a91c-4fb16462065e" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::tests::coap::command] Sending payload
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::tests::coap::command] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgwMjksImlhdCI6MTYzMTgwNzcyOSwiYXV0aF90aW1lIjoxNjMxODA3NzI2LCJqdGkiOiIwOTNkMDk2OC0yNzg1LTQzNDYtOTk1NS0xODBjMDIyNWVkZWMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImU4ZjRiMTQ1LTEzZmItNGE4Ni1hYWJlLTYzYmMzMjBlZmU0OCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlOGY0YjE0NS0xM2ZiLTRhODYtYWFiZS02M2JjMzIwZWZlNDgiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.eAZhvqRtLPj3l0--Kg98Uatho1zicPsTm8Gp6Y0pub2v9f7Na0wX9uOg0dfPfgi88Ks9a7jsVhDSHNzFLvKWSz8mIUQZxselQXNmDq_s7_c8IXW0TqRtQiLXmSzm4Q8fp2-HUkIOTNur4URh92DMJhfBJLZVSlvjA45wmVVCop8k5kNa8hM6xVhu8Fn0BjIxPDlH1XAravfSiHudMCXwGrUf_zxuVHQsDCamojwisSPuqyq2Mlj6toDFJ7_BCVN-4D10ZoXosYGOYQ5M9WC0Ib9qXLVKtZAEMZj5ZjuB8KqikSqQjl3Qr024OK1U-K3DhiKDP-9WRuccnHwSbVCOXQ\n", stderr: "" })
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:55:31Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:55:33Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:55:33Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:55:34Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:55:34Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:55:35Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:55:35Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:55:35Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 11, payload: 0x7f0074016050, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638431ba8c0 } }, data: MessageData { topic: "app/3963f4e4-3980-4cdc-a91c-4fb16462065e", payload: [123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125], props: Properties { cprops: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638431ba8c0 } } } }
[2021-09-16T15:55:35Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/3963f4e4-3980-4cdc-a91c-4fb16462065e", content_type: Some("application/json"), user_properties: {"source": "drogue://3963f4e4%2D3980%2D4cdc%2Da91c%2D4fb16462065e/device1", "partitionkey": "3963f4e4%2D3980%2D4cdc%2Da91c%2D4fb16462065e/device1", "device": "device1", "application": "3963f4e4-3980-4cdc-a91c-4fb16462065e", "type": "io.drogue.event.v1", "subject": "warmup", "instance": "drogue", "id": "e70b3f9a-7d67-4bb6-b9f0-7d34124099fb", "time": "2021-09-16T15:55:35.111962813+00:00", "specversion": "1.0"}, payload: "{\"index\":3}" }
[2021-09-16T15:55:36Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T15:55:36Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    99,
                    116,
                    61,
                    54,
                    48,
                    48,
                    48,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    65,
                    122,
                    79,
                    84,
                    89,
                    122,
                    90,
                    106,
                    82,
                    108,
                    78,
                    67,
                    48,
                    122,
                    79,
                    84,
                    103,
                    119,
                    76,
                    84,
                    82,
                    106,
                    90,
                    71,
                    77,
                    116,
                    89,
                    84,
                    107,
                    120,
                    89,
                    121,
                    48,
                    48,
                    90,
                    109,
                    73,
                    120,
                    78,
                    106,
                    81,
                    50,
                    77,
                    106,
                    65,
                    50,
                    78,
                    87,
                    85,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:56:11Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:56:11Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "3963f4e4-3980-4cdc-a91c-4fb16462065e" "device1"
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::resources::apps] Destroy application '3963f4e4-3980-4cdc-a91c-4fb16462065e'
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "3963f4e4-3980-4cdc-a91c-4fb16462065e"
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 3963f4e4-3980-4cdc-a91c-4fb16462065e deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_pass::version_1

**Duration**: 50.799131124s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:56:12Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T15:56:15Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:56:19Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk1NzksImlhdCI6MTYzMTgwNzc3OSwianRpIjoiOGJhM2ZhNGYtODU0Yi00ZDdjLTg5MzgtYjUzNjQzNWNlNWM2IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOThjY2U0ZDMtOTU5ZS00YTVkLTlkMjItNDZiYmRlNzU1ZDZjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6Ijk4Y2NlNGQzLTk1OWUtNGE1ZC05ZDIyLTQ2YmJkZTc1NWQ2YyJ9.-WK1sRIf5WBu4BbARv_bGtwngZq7rSs3Cl3KfhTO9nE
[2021-09-16T15:56:19Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:56:19Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:56:19Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk1NzksImlhdCI6MTYzMTgwNzc3OSwianRpIjoiOGJhM2ZhNGYtODU0Yi00ZDdjLTg5MzgtYjUzNjQzNWNlNWM2IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOThjY2U0ZDMtOTU5ZS00YTVkLTlkMjItNDZiYmRlNzU1ZDZjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6Ijk4Y2NlNGQzLTk1OWUtNGE1ZC05ZDIyLTQ2YmJkZTc1NWQ2YyJ9.-WK1sRIf5WBu4BbARv_bGtwngZq7rSs3Cl3KfhTO9nE" "--context" "system-tests"
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgwODAsImlhdCI6MTYzMTgwNzc4MCwiYXV0aF90aW1lIjoxNjMxODA3Nzc3LCJqdGkiOiI2ZmY2NDJkYi1mN2U3LTQwNjEtOGQyNS1lY2RkYmFlYTE0YTQiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6Ijk4Y2NlNGQzLTk1OWUtNGE1ZC05ZDIyLTQ2YmJkZTc1NWQ2YyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI5OGNjZTRkMy05NTllLTRhNWQtOWQyMi00NmJiZGU3NTVkNmMiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.QHtCr6uPd_nymWMYWkO3kQwGjxuVBCrzKATkVLDTzt7g65IFVvTVbZFXOp9AQokPo82nlL-iK6g7o393DeBbHwWALHCIo1dxURH1HSSbPQfLLxF3RwXFyAqw2htw4znVXNntN7JAHXCSx109VC0_QeYjq6t3FIU1T1Iw71tR8JOMJdZXS2IYVc-TU9nOORDb2M9WSDZoj-QYZzV9laRI3F3ooeFzQ5aaMUB5FwRzL4ZdO-nSeCfvzjcO4oSOFeOuXL38_IYSGwFB3HrQpXMlL6HtPACODhhOxEl4MtK21FlH0900v1ac6g0glUsPjCJgVzL9cuDviPkk7ItBVvzVSg\n", stderr: "" })
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::resources::apps] Create application: b908bcec-1ae1-4af1-9440-48d068f2491d
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "b908bcec-1ae1-4af1-9440-48d068f2491d"
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App b908bcec-1ae1-4af1-9440-48d068f2491d created.\n", stderr: "" })
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "b908bcec-1ae1-4af1-9440-48d068f2491d"
[2021-09-16T15:56:20Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:56:20.750332Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"b908bcec-1ae1-4af1-9440-48d068f2491d\",\n    \"resourceVersion\": \"5c49865a-a547-44a9-940e-3d87fa6796b2\",\n    \"uid\": \"379e04f5-a1a6-4711-9e3d-00ef48d36619\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:20.765845891Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:20.765859146Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765821225Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765822999Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765823500Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765824332Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765824742Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.765827036Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "b908bcec-1ae1-4af1-9440-48d068f2491d"
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:56:20.750332Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"b908bcec-1ae1-4af1-9440-48d068f2491d\",\n    \"resourceVersion\": \"77d25e3c-f63c-4c60-a326-454355667232\",\n    \"uid\": \"379e04f5-a1a6-4711-9e3d-00ef48d36619\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:21.112522926Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:21.112572427Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.797386846Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.803704708Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.923890401Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.932024803Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:21.112491458Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:21.112493872Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"uQirIpryUNRv\",\n        \"username\": \"user-b908bcec-1ae1-4af1-9440-48d068f2491d\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "b908bcec-1ae1-4af1-9440-48d068f2491d"
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:56:20.750332Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"b908bcec-1ae1-4af1-9440-48d068f2491d\",\n    \"resourceVersion\": \"77d25e3c-f63c-4c60-a326-454355667232\",\n    \"uid\": \"379e04f5-a1a6-4711-9e3d-00ef48d36619\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:21.112522926Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:56:21.112572427Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.797386846Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.803704708Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.923890401Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:20.932024803Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:21.112491458Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:56:21.112493872Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"uQirIpryUNRv\",\n        \"username\": \"user-b908bcec-1ae1-4af1-9440-48d068f2491d\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "b908bcec-1ae1-4af1-9440-48d068f2491d" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:56:21Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgwODAsImlhdCI6MTYzMTgwNzc4MCwiYXV0aF90aW1lIjoxNjMxODA3Nzc3LCJqdGkiOiI2ZmY2NDJkYi1mN2U3LTQwNjEtOGQyNS1lY2RkYmFlYTE0YTQiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6Ijk4Y2NlNGQzLTk1OWUtNGE1ZC05ZDIyLTQ2YmJkZTc1NWQ2YyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI5OGNjZTRkMy05NTllLTRhNWQtOWQyMi00NmJiZGU3NTVkNmMiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.QHtCr6uPd_nymWMYWkO3kQwGjxuVBCrzKATkVLDTzt7g65IFVvTVbZFXOp9AQokPo82nlL-iK6g7o393DeBbHwWALHCIo1dxURH1HSSbPQfLLxF3RwXFyAqw2htw4znVXNntN7JAHXCSx109VC0_QeYjq6t3FIU1T1Iw71tR8JOMJdZXS2IYVc-TU9nOORDb2M9WSDZoj-QYZzV9laRI3F3ooeFzQ5aaMUB5FwRzL4ZdO-nSeCfvzjcO4oSOFeOuXL38_IYSGwFB3HrQpXMlL6HtPACODhhOxEl4MtK21FlH0900v1ac6g0glUsPjCJgVzL9cuDviPkk7ItBVvzVSg\n", stderr: "" })
[2021-09-16T15:56:22Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T15:56:22Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:22Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:56:22Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:56:23Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:23Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:56:24Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:24Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:56:25Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:25Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:56:26Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:56:26Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:56:26Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0078014bf0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/b908bcec-1ae1-4af1-9440-48d068f2491d", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 55, 53, 100, 101, 50, 99, 56, 52, 45, 53, 52, 55, 99, 45, 52, 56, 53, 102, 45, 57, 53, 48, 102, 45, 53, 48, 102, 97, 100, 102, 51, 52, 51, 98, 101, 102, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 98, 57, 48, 56, 98, 99, 101, 99, 37, 50, 68, 49, 97, 101, 49, 37, 50, 68, 52, 97, 102, 49, 37, 50, 68, 57, 52, 52, 48, 37, 50, 68, 52, 56, 100, 48, 54, 56, 102, 50, 52, 57, 49, 100, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 54, 58, 50, 54, 46, 49, 53, 50, 53, 56, 50, 54, 48, 56, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 98, 57, 48, 56, 98, 99, 101, 99, 45, 49, 97, 101, 49, 45, 52, 97, 102, 49, 45, 57, 52, 52, 48, 45, 52, 56, 100, 48, 54, 56, 102, 50, 52, 57, 49, 100, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 98, 57, 48, 56, 98, 99, 101, 99, 37, 50, 68, 49, 97, 101, 49, 37, 50, 68, 52, 97, 102, 49, 37, 50, 68, 57, 52, 52, 48, 37, 50, 68, 52, 56, 100, 48, 54, 56, 102, 50, 52, 57, 49, 100, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T15:56:26Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/b908bcec-1ae1-4af1-9440-48d068f2491d", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"75de2c84-547c-485f-950f-50fadf343bef\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://b908bcec%2D1ae1%2D4af1%2D9440%2D48d068f2491d/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:56:26.152582608Z\",\"data\":{\"index\":4},\"application\":\"b908bcec-1ae1-4af1-9440-48d068f2491d\",\"partitionkey\":\"b908bcec%2D1ae1%2D4af1%2D9440%2D48d068f2491d/device1\",\"instance\":\"drogue\",\"device\":\"device1\"}" }
[2021-09-16T15:56:27Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T15:56:27Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T15:56:27Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    66,
                    105,
                    79,
                    84,
                    65,
                    52,
                    89,
                    109,
                    78,
                    108,
                    89,
                    121,
                    48,
                    120,
                    89,
                    87,
                    85,
                    120,
                    76,
                    84,
                    82,
                    104,
                    90,
                    106,
                    69,
                    116,
                    79,
                    84,
                    81,
                    48,
                    77,
                    67,
                    48,
                    48,
                    79,
                    71,
                    81,
                    119,
                    78,
                    106,
                    104,
                    109,
                    77,
                    106,
                    81,
                    53,
                    77,
                    87,
                    81,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:57:03Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "b908bcec-1ae1-4af1-9440-48d068f2491d" "device1"
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::resources::apps] Destroy application 'b908bcec-1ae1-4af1-9440-48d068f2491d'
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "b908bcec-1ae1-4af1-9440-48d068f2491d"
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App b908bcec-1ae1-4af1-9440-48d068f2491d deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_pass::version_2

**Duration**: 49.050912649s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:57:03Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T15:57:05Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:57:10Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk2MzAsImlhdCI6MTYzMTgwNzgzMCwianRpIjoiMmE4MDEyNmEtZmI2My00MjcxLWE3ZDAtNjk1MGIwZmQxZjUyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZTM3ZDBkMDctMGZhZi00MjRlLTgzMWItNDU1Y2FkNzE1OWYwIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImUzN2QwZDA3LTBmYWYtNDI0ZS04MzFiLTQ1NWNhZDcxNTlmMCJ9.Y0jqFVSQwhXgEgqBhq88KmsNrhDBtcrKizz4PHwYp9A
[2021-09-16T15:57:10Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:57:10Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:57:10Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk2MzAsImlhdCI6MTYzMTgwNzgzMCwianRpIjoiMmE4MDEyNmEtZmI2My00MjcxLWE3ZDAtNjk1MGIwZmQxZjUyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZTM3ZDBkMDctMGZhZi00MjRlLTgzMWItNDU1Y2FkNzE1OWYwIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImUzN2QwZDA3LTBmYWYtNDI0ZS04MzFiLTQ1NWNhZDcxNTlmMCJ9.Y0jqFVSQwhXgEgqBhq88KmsNrhDBtcrKizz4PHwYp9A" "--context" "system-tests"
[2021-09-16T15:57:10Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgxMzAsImlhdCI6MTYzMTgwNzgzMCwiYXV0aF90aW1lIjoxNjMxODA3ODI3LCJqdGkiOiI2NjAwYTgwYi1mMjcyLTRkOTQtYWZkMS03OTk1OTcwYjRiNGEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImUzN2QwZDA3LTBmYWYtNDI0ZS04MzFiLTQ1NWNhZDcxNTlmMCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlMzdkMGQwNy0wZmFmLTQyNGUtODMxYi00NTVjYWQ3MTU5ZjAiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.X0mVLTljLS0aCWO9OYRllH2-xrDSDhvYnEXVdHdNMF6EkJmTMYRAt3DuNfNZfG7CR-t-TF1Lx0Ggxx_iG5gv_zy_9OGVu02sWVNVKRtiNZxfM-dJkhTELReLg6zrQbm2_l1im78litA-ye91NmQ5l1TQEsVbfECgyvoy1o8dOjY-l2x2fVBue_RXE4K4V3PGVs1LzxM9a6Mph3tJKv09RXheCa2zvdhxJS48J6gfH0oUGqUFXzreF-mXhtlQ8GxUaPUegIr7DOz1l0p2idtJ4caJr-jAHSEbGiNnmBwiyvD8UEhN6mKjSL0G34HlC5p4_3a0pmzj29H6F-IISQCNkg\n", stderr: "" })
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::resources::apps] Create application: 6a8c5160-e89c-4724-bafd-06467c0901da
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "6a8c5160-e89c-4724-bafd-06467c0901da"
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6a8c5160-e89c-4724-bafd-06467c0901da created.\n", stderr: "" })
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6a8c5160-e89c-4724-bafd-06467c0901da"
[2021-09-16T15:57:11Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:57:11.313451Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"6a8c5160-e89c-4724-bafd-06467c0901da\",\n    \"resourceVersion\": \"866f627b-e34a-4ade-bddc-820db46db2ec\",\n    \"uid\": \"b83c3560-3a8b-42c3-ae0f-3016fb7bf383\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.325472684Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.325530491Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325449191Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325450814Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325451616Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325452327Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325452648Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.325455242Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6a8c5160-e89c-4724-bafd-06467c0901da"
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:57:11.313451Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"6a8c5160-e89c-4724-bafd-06467c0901da\",\n    \"resourceVersion\": \"2a446619-ef3c-41bf-b50b-e5c6352eb569\",\n    \"uid\": \"b83c3560-3a8b-42c3-ae0f-3016fb7bf383\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.778920822Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.778954274Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.359420851Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.368150900Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.584281105Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.594016908Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.778893090Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.778894954Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"edhwcpNnwXET\",\n        \"username\": \"user-6a8c5160-e89c-4724-bafd-06467c0901da\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6a8c5160-e89c-4724-bafd-06467c0901da"
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:57:11.313451Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"6a8c5160-e89c-4724-bafd-06467c0901da\",\n    \"resourceVersion\": \"2a446619-ef3c-41bf-b50b-e5c6352eb569\",\n    \"uid\": \"b83c3560-3a8b-42c3-ae0f-3016fb7bf383\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.778920822Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:57:11.778954274Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.359420851Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.368150900Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.584281105Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.594016908Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.778893090Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:57:11.778894954Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"edhwcpNnwXET\",\n        \"username\": \"user-6a8c5160-e89c-4724-bafd-06467c0901da\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "6a8c5160-e89c-4724-bafd-06467c0901da" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgxMzAsImlhdCI6MTYzMTgwNzgzMCwiYXV0aF90aW1lIjoxNjMxODA3ODI3LCJqdGkiOiI2NjAwYTgwYi1mMjcyLTRkOTQtYWZkMS03OTk1OTcwYjRiNGEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImUzN2QwZDA3LTBmYWYtNDI0ZS04MzFiLTQ1NWNhZDcxNTlmMCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlMzdkMGQwNy0wZmFmLTQyNGUtODMxYi00NTVjYWQ3MTU5ZjAiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.X0mVLTljLS0aCWO9OYRllH2-xrDSDhvYnEXVdHdNMF6EkJmTMYRAt3DuNfNZfG7CR-t-TF1Lx0Ggxx_iG5gv_zy_9OGVu02sWVNVKRtiNZxfM-dJkhTELReLg6zrQbm2_l1im78litA-ye91NmQ5l1TQEsVbfECgyvoy1o8dOjY-l2x2fVBue_RXE4K4V3PGVs1LzxM9a6Mph3tJKv09RXheCa2zvdhxJS48J6gfH0oUGqUFXzreF-mXhtlQ8GxUaPUegIr7DOz1l0p2idtJ4caJr-jAHSEbGiNnmBwiyvD8UEhN6mKjSL0G34HlC5p4_3a0pmzj29H6F-IISQCNkg\n", stderr: "" })
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:57:12Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:57:14Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:57:14Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:57:15Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:57:15Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:57:16Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:57:16Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:57:16Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f007401a6c0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f007401a890 } }, data: MessageData { topic: "app/6a8c5160-e89c-4724-bafd-06467c0901da", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 56, 53, 48, 55, 48, 48, 52, 55, 45, 53, 48, 98, 102, 45, 52, 102, 56, 101, 45, 57, 99, 51, 100, 45, 98, 102, 55, 52, 57, 56, 99, 52, 52, 102, 54, 51, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 54, 97, 56, 99, 53, 49, 54, 48, 37, 50, 68, 101, 56, 57, 99, 37, 50, 68, 52, 55, 50, 52, 37, 50, 68, 98, 97, 102, 100, 37, 50, 68, 48, 54, 52, 54, 55, 99, 48, 57, 48, 49, 100, 97, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 55, 58, 49, 54, 46, 49, 52, 50, 53, 48, 52, 56, 53, 48, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 54, 97, 56, 99, 53, 49, 54, 48, 37, 50, 68, 101, 56, 57, 99, 37, 50, 68, 52, 55, 50, 52, 37, 50, 68, 98, 97, 102, 100, 37, 50, 68, 48, 54, 52, 54, 55, 99, 48, 57, 48, 49, 100, 97, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 54, 97, 56, 99, 53, 49, 54, 48, 45, 101, 56, 57, 99, 45, 52, 55, 50, 52, 45, 98, 97, 102, 100, 45, 48, 54, 52, 54, 55, 99, 48, 57, 48, 49, 100, 97, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f007401a890 } } } }
[2021-09-16T15:57:16Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/6a8c5160-e89c-4724-bafd-06467c0901da", content_type: Some("application/cloudevents+json; charset=utf-8"), user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"85070047-50bf-4f8e-9c3d-bf7498c44f63\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://6a8c5160%2De89c%2D4724%2Dbafd%2D06467c0901da/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:57:16.142504850Z\",\"data\":{\"index\":3},\"instance\":\"drogue\",\"partitionkey\":\"6a8c5160%2De89c%2D4724%2Dbafd%2D06467c0901da/device1\",\"application\":\"6a8c5160-e89c-4724-bafd-06467c0901da\",\"device\":\"device1\"}" }
[2021-09-16T15:57:17Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T15:57:17Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T15:57:17Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    65,
                    50,
                    89,
                    84,
                    104,
                    106,
                    78,
                    84,
                    69,
                    50,
                    77,
                    67,
                    49,
                    108,
                    79,
                    68,
                    108,
                    106,
                    76,
                    84,
                    81,
                    51,
                    77,
                    106,
                    81,
                    116,
                    89,
                    109,
                    70,
                    109,
                    90,
                    67,
                    48,
                    119,
                    78,
                    106,
                    81,
                    50,
                    78,
                    50,
                    77,
                    119,
                    79,
                    84,
                    65,
                    120,
                    90,
                    71,
                    69,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:57:52Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "6a8c5160-e89c-4724-bafd-06467c0901da" "device1"
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::resources::apps] Destroy application '6a8c5160-e89c-4724-bafd-06467c0901da'
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "6a8c5160-e89c-4724-bafd-06467c0901da"
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6a8c5160-e89c-4724-bafd-06467c0901da deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_pass::version_3

**Duration**: 49.150559331s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:57:52Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T15:57:54Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:57:59Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk2NzksImlhdCI6MTYzMTgwNzg3OSwianRpIjoiODYwOTY5YzUtNWQxNS00OWY3LWI1ODYtMWU5NDkzMzUwYjJjIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZDljODNmYmMtZTQ2ZC00NDMwLWFhZDYtNzM5MTkxNTQ0MzZjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImQ5YzgzZmJjLWU0NmQtNDQzMC1hYWQ2LTczOTE5MTU0NDM2YyJ9.kgJz74G-APY-1IEPWobv24JJLqnn62DSglZwEnm-npk
[2021-09-16T15:57:59Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:57:59Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:57:59Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk2NzksImlhdCI6MTYzMTgwNzg3OSwianRpIjoiODYwOTY5YzUtNWQxNS00OWY3LWI1ODYtMWU5NDkzMzUwYjJjIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZDljODNmYmMtZTQ2ZC00NDMwLWFhZDYtNzM5MTkxNTQ0MzZjIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImQ5YzgzZmJjLWU0NmQtNDQzMC1hYWQ2LTczOTE5MTU0NDM2YyJ9.kgJz74G-APY-1IEPWobv24JJLqnn62DSglZwEnm-npk" "--context" "system-tests"
[2021-09-16T15:57:59Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgxNzksImlhdCI6MTYzMTgwNzg3OSwiYXV0aF90aW1lIjoxNjMxODA3ODc2LCJqdGkiOiI4NmJiNWE2NS1iZmI1LTQxZDQtODRlOC1mZWU3YzBjY2FmOWMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImQ5YzgzZmJjLWU0NmQtNDQzMC1hYWQ2LTczOTE5MTU0NDM2YyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJkOWM4M2ZiYy1lNDZkLTQ0MzAtYWFkNi03MzkxOTE1NDQzNmMiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.ewAV_AeT34qXB8NcRSCmkCHomO1csNnkrMiXbnN_5K0dX9I9-tK-XWWf30Zu_cFJF2t41jUV7SGOGNUChtygSUynWq7h089OrynoHsnT8pmLmTcfZcQtUB1D3isc2ATWs59DZlUgaDEwBsx5nLwZG3gRBwA-fE7KFbTeUfR5DkR7G29DrVhaODFZzgS8KpopqJ7g4_sVz9DmbsNToY0IlNkkoFOWKxlitxQ3R6rH9Ku0-sw65HAc_QZ8pwJ0qm5WWb5fmFqnu_aGd3IhNDqY9-PQlktfxgqRjJYSZSLS0o2kDUMPSp28VB2P0O1FRcPFsFTlk7UC5vkrrrrvF_879w\n", stderr: "" })
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::resources::apps] Create application: 777b9b32-d489-481e-b104-968f9dff96d4
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "777b9b32-d489-481e-b104-968f9dff96d4"
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 777b9b32-d489-481e-b104-968f9dff96d4 created.\n", stderr: "" })
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "777b9b32-d489-481e-b104-968f9dff96d4"
[2021-09-16T15:58:00Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:00.469675Z\",\n    \"generation\": 1,\n    \"name\": \"777b9b32-d489-481e-b104-968f9dff96d4\",\n    \"resourceVersion\": \"f81ce5b9-a8dc-4c80-bc9c-559fc0495748\",\n    \"uid\": \"af071832-112a-4241-a9a8-9661bb6bc235\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:00.492785625Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ]\n  }\n}", stderr: "" })
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "777b9b32-d489-481e-b104-968f9dff96d4"
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:00.469675Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"777b9b32-d489-481e-b104-968f9dff96d4\",\n    \"resourceVersion\": \"464e5630-0011-4b11-aa20-e24e99a4eb67\",\n    \"uid\": \"af071832-112a-4241-a9a8-9661bb6bc235\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:01.038842512Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:01.038814941Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.575204051Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.581663076Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.755504034Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.766905686Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:01.038780457Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:01.038782320Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"taIeb6b5YA6u\",\n        \"username\": \"user-777b9b32-d489-481e-b104-968f9dff96d4\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "777b9b32-d489-481e-b104-968f9dff96d4"
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:00.469675Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"777b9b32-d489-481e-b104-968f9dff96d4\",\n    \"resourceVersion\": \"464e5630-0011-4b11-aa20-e24e99a4eb67\",\n    \"uid\": \"af071832-112a-4241-a9a8-9661bb6bc235\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:01.038842512Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:01.038814941Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.575204051Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.581663076Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.755504034Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:00.766905686Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:01.038780457Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:01.038782320Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"taIeb6b5YA6u\",\n        \"username\": \"user-777b9b32-d489-481e-b104-968f9dff96d4\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "777b9b32-d489-481e-b104-968f9dff96d4" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"pass\":\"foo\"}]}}"
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgxNzksImlhdCI6MTYzMTgwNzg3OSwiYXV0aF90aW1lIjoxNjMxODA3ODc2LCJqdGkiOiI4NmJiNWE2NS1iZmI1LTQxZDQtODRlOC1mZWU3YzBjY2FmOWMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImQ5YzgzZmJjLWU0NmQtNDQzMC1hYWQ2LTczOTE5MTU0NDM2YyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJkOWM4M2ZiYy1lNDZkLTQ0MzAtYWFkNi03MzkxOTE1NDQzNmMiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.ewAV_AeT34qXB8NcRSCmkCHomO1csNnkrMiXbnN_5K0dX9I9-tK-XWWf30Zu_cFJF2t41jUV7SGOGNUChtygSUynWq7h089OrynoHsnT8pmLmTcfZcQtUB1D3isc2ATWs59DZlUgaDEwBsx5nLwZG3gRBwA-fE7KFbTeUfR5DkR7G29DrVhaODFZzgS8KpopqJ7g4_sVz9DmbsNToY0IlNkkoFOWKxlitxQ3R6rH9Ku0-sw65HAc_QZ8pwJ0qm5WWb5fmFqnu_aGd3IhNDqY9-PQlktfxgqRjJYSZSLS0o2kDUMPSp28VB2P0O1FRcPFsFTlk7UC5vkrrrrvF_879w\n", stderr: "" })
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:58:01Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:03Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:03Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:04Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:04Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:05Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:05Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:05Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 11, payload: 0x7f0080016dc0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x56384346e640 } }, data: MessageData { topic: "app/777b9b32-d489-481e-b104-968f9dff96d4", payload: [123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125], props: Properties { cprops: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x56384346e640 } } } }
[2021-09-16T15:58:05Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/777b9b32-d489-481e-b104-968f9dff96d4", content_type: Some("application/json"), user_properties: {"device": "device1", "specversion": "1.0", "subject": "warmup", "time": "2021-09-16T15:58:05.177812356+00:00", "type": "io.drogue.event.v1", "source": "drogue://777b9b32%2Dd489%2D481e%2Db104%2D968f9dff96d4/device1", "application": "777b9b32-d489-481e-b104-968f9dff96d4", "instance": "drogue", "partitionkey": "777b9b32%2Dd489%2D481e%2Db104%2D968f9dff96d4/device1", "id": "f4b5dbe1-8655-4a2d-a1e1-8be5a5319b28"}, payload: "{\"index\":3}" }
[2021-09-16T15:58:06Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T15:58:06Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T15:58:06Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    71,
                    86,
                    50,
                    97,
                    87,
                    78,
                    108,
                    77,
                    85,
                    65,
                    51,
                    78,
                    122,
                    100,
                    105,
                    79,
                    87,
                    73,
                    122,
                    77,
                    105,
                    49,
                    107,
                    78,
                    68,
                    103,
                    53,
                    76,
                    84,
                    81,
                    52,
                    77,
                    87,
                    85,
                    116,
                    89,
                    106,
                    69,
                    119,
                    78,
                    67,
                    48,
                    53,
                    78,
                    106,
                    104,
                    109,
                    79,
                    87,
                    82,
                    109,
                    90,
                    106,
                    107,
                    50,
                    90,
                    68,
                    81,
                    54,
                    90,
                    109,
                    57,
                    118,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:58:41Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "777b9b32-d489-481e-b104-968f9dff96d4" "device1"
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::resources::apps] Destroy application '777b9b32-d489-481e-b104-968f9dff96d4'
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "777b9b32-d489-481e-b104-968f9dff96d4"
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 777b9b32-d489-481e-b104-968f9dff96d4 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user::version_1

**Duration**: 52.087715086s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:58:41Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T15:58:44Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk3MjgsImlhdCI6MTYzMTgwNzkyOCwianRpIjoiNzExNmEyNGYtMzllMi00OTU1LWE3ZjQtYjA5ODM1N2Y3MDM5IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZTI0MmI0MGUtMzhjYy00ZjhjLWJiNGItYTBiMWZhYmU2NjQ1Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImUyNDJiNDBlLTM4Y2MtNGY4Yy1iYjRiLWEwYjFmYWJlNjY0NSJ9.-Q2ovzW7wIjzaVuJlGiSYWeROlvy7S-Yzwg0UAL6QUg
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk3MjgsImlhdCI6MTYzMTgwNzkyOCwianRpIjoiNzExNmEyNGYtMzllMi00OTU1LWE3ZjQtYjA5ODM1N2Y3MDM5IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiZTI0MmI0MGUtMzhjYy00ZjhjLWJiNGItYTBiMWZhYmU2NjQ1Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImUyNDJiNDBlLTM4Y2MtNGY4Yy1iYjRiLWEwYjFmYWJlNjY0NSJ9.-Q2ovzW7wIjzaVuJlGiSYWeROlvy7S-Yzwg0UAL6QUg" "--context" "system-tests"
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgyMjksImlhdCI6MTYzMTgwNzkyOSwiYXV0aF90aW1lIjoxNjMxODA3OTI2LCJqdGkiOiIzZmIyMTA2Ni0wNGU2LTRlOTctOWJmMS02ZTM3NzU1N2QwMmIiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImUyNDJiNDBlLTM4Y2MtNGY4Yy1iYjRiLWEwYjFmYWJlNjY0NSIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlMjQyYjQwZS0zOGNjLTRmOGMtYmI0Yi1hMGIxZmFiZTY2NDUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.G-yfZ-97MW1Rjk6AFvvMC3E2QdBfGCWILlMQSLkfpJLiILhpWrdkQATn-YOhY0SQ4VIM5xrnpJoXG3iyP073Jb_E4cnvheSzlgFdPhDL5ntQ-bDJLisncsypj_XP4Bh2x8w2lnMivMk5K2cHf-XhRn1PSokuXTs0ytscy40ZWyYpp-J1ql42CLzgHZwJtf-vx5zvPfCoNLF-AjaA9PCb6pjfu_EZ4Sc-LITDHALqvcmuAfEMxeUucIvB6qtR03dfw1FMvMgYvc-dv9I4txWvfKlVe9BrtRJZUKUn9kV9_SsaM86A89Qj6XOn4D9swZ8jJ2RAkJyq7UwWo2aC0uW6jw\n", stderr: "" })
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::resources::apps] Create application: 183933fa-1758-4ec8-97d7-0939918e7f47
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "183933fa-1758-4ec8-97d7-0939918e7f47"
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 183933fa-1758-4ec8-97d7-0939918e7f47 created.\n", stderr: "" })
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "183933fa-1758-4ec8-97d7-0939918e7f47"
[2021-09-16T15:58:49Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:49.907466Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"183933fa-1758-4ec8-97d7-0939918e7f47\",\n    \"resourceVersion\": \"ea22a356-6d59-42d1-aa8c-631e7dac1a5e\",\n    \"uid\": \"1640d843-7425-427f-b319-2ba057e69282\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:49.932422391Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:49.932433732Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932398296Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932400460Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932400951Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932401793Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932402113Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.932404217Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "183933fa-1758-4ec8-97d7-0939918e7f47"
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:49.907466Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"183933fa-1758-4ec8-97d7-0939918e7f47\",\n    \"resourceVersion\": \"167e6786-59bd-4460-9d6d-8a01a47a797c\",\n    \"uid\": \"1640d843-7425-427f-b319-2ba057e69282\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:50.540583065Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:50.540622597Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.971247148Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.977781058Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.277557148Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.290310944Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.540552938Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.540555322Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ygDXo2drdtPP\",\n        \"username\": \"user-183933fa-1758-4ec8-97d7-0939918e7f47\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "183933fa-1758-4ec8-97d7-0939918e7f47"
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:58:49.907466Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"183933fa-1758-4ec8-97d7-0939918e7f47\",\n    \"resourceVersion\": \"167e6786-59bd-4460-9d6d-8a01a47a797c\",\n    \"uid\": \"1640d843-7425-427f-b319-2ba057e69282\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:50.540583065Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:58:50.540622597Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.971247148Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:49.977781058Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.277557148Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.290310944Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.540552938Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:58:50.540555322Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ygDXo2drdtPP\",\n        \"username\": \"user-183933fa-1758-4ec8-97d7-0939918e7f47\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:58:50Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "183933fa-1758-4ec8-97d7-0939918e7f47" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgyMjksImlhdCI6MTYzMTgwNzkyOSwiYXV0aF90aW1lIjoxNjMxODA3OTI2LCJqdGkiOiIzZmIyMTA2Ni0wNGU2LTRlOTctOWJmMS02ZTM3NzU1N2QwMmIiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImUyNDJiNDBlLTM4Y2MtNGY4Yy1iYjRiLWEwYjFmYWJlNjY0NSIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJlMjQyYjQwZS0zOGNjLTRmOGMtYmI0Yi1hMGIxZmFiZTY2NDUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.G-yfZ-97MW1Rjk6AFvvMC3E2QdBfGCWILlMQSLkfpJLiILhpWrdkQATn-YOhY0SQ4VIM5xrnpJoXG3iyP073Jb_E4cnvheSzlgFdPhDL5ntQ-bDJLisncsypj_XP4Bh2x8w2lnMivMk5K2cHf-XhRn1PSokuXTs0ytscy40ZWyYpp-J1ql42CLzgHZwJtf-vx5zvPfCoNLF-AjaA9PCb6pjfu_EZ4Sc-LITDHALqvcmuAfEMxeUucIvB6qtR03dfw1FMvMgYvc-dv9I4txWvfKlVe9BrtRJZUKUn9kV9_SsaM86A89Qj6XOn4D9swZ8jJ2RAkJyq7UwWo2aC0uW6jw\n", stderr: "" })
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:51Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:53Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:53Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:54Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:54Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:55Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:55Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:56Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:58:56Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:58:56Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0078014e30, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/183933fa-1758-4ec8-97d7-0939918e7f47", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 102, 49, 48, 52, 97, 48, 101, 99, 45, 97, 99, 98, 53, 45, 52, 102, 51, 57, 45, 57, 100, 57, 56, 45, 56, 54, 57, 56, 57, 99, 49, 97, 54, 50, 54, 98, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 49, 56, 51, 57, 51, 51, 102, 97, 37, 50, 68, 49, 55, 53, 56, 37, 50, 68, 52, 101, 99, 56, 37, 50, 68, 57, 55, 100, 55, 37, 50, 68, 48, 57, 51, 57, 57, 49, 56, 101, 55, 102, 52, 55, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 56, 58, 53, 54, 46, 49, 55, 55, 48, 53, 48, 54, 55, 52, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 49, 56, 51, 57, 51, 51, 102, 97, 45, 49, 55, 53, 56, 45, 52, 101, 99, 56, 45, 57, 55, 100, 55, 45, 48, 57, 51, 57, 57, 49, 56, 101, 55, 102, 52, 55, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 49, 56, 51, 57, 51, 51, 102, 97, 37, 50, 68, 49, 55, 53, 56, 37, 50, 68, 52, 101, 99, 56, 37, 50, 68, 57, 55, 100, 55, 37, 50, 68, 48, 57, 51, 57, 57, 49, 56, 101, 55, 102, 52, 55, 47, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T15:58:56Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/183933fa-1758-4ec8-97d7-0939918e7f47", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"f104a0ec-acb5-4f39-9d98-86989c1a626b\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://183933fa%2D1758%2D4ec8%2D97d7%2D0939918e7f47/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:58:56.177050674Z\",\"data\":{\"index\":4},\"device\":\"device1\",\"application\":\"183933fa-1758-4ec8-97d7-0939918e7f47\",\"instance\":\"drogue\",\"partitionkey\":\"183933fa%2D1758%2D4ec8%2D97d7%2D0939918e7f47/device1\"}" }
[2021-09-16T15:58:57Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T15:58:57Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T15:58:57Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    68,
                    69,
                    52,
                    77,
                    122,
                    107,
                    122,
                    77,
                    50,
                    90,
                    104,
                    76,
                    84,
                    69,
                    51,
                    78,
                    84,
                    103,
                    116,
                    78,
                    71,
                    86,
                    106,
                    79,
                    67,
                    48,
                    53,
                    78,
                    50,
                    81,
                    51,
                    76,
                    84,
                    65,
                    53,
                    77,
                    122,
                    107,
                    53,
                    77,
                    84,
                    104,
                    108,
                    78,
                    50,
                    89,
                    48,
                    78,
                    122,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T15:59:32Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T15:59:32Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "183933fa-1758-4ec8-97d7-0939918e7f47" "device1"
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::resources::apps] Destroy application '183933fa-1758-4ec8-97d7-0939918e7f47'
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "183933fa-1758-4ec8-97d7-0939918e7f47"
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 183933fa-1758-4ec8-97d7-0939918e7f47 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user::version_2

**Duration**: 51.095604543s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T15:59:33Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T15:59:36Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T15:59:41Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk3ODAsImlhdCI6MTYzMTgwNzk4MCwianRpIjoiZTIzMDQwMmEtMzY2OC00OWRkLThlNmItNTIxYjhhM2JjYzIzIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYTMyNzVhZDMtYzMyZi00ODE3LTk4MTUtMmMzZmQ2YzQyYjkwIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImEzMjc1YWQzLWMzMmYtNDgxNy05ODE1LTJjM2ZkNmM0MmI5MCJ9.iektPJa0JGlmgxD9but9jt2SzZu3JteOlsk1TL-h8GU
[2021-09-16T15:59:41Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T15:59:41Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T15:59:41Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk3ODAsImlhdCI6MTYzMTgwNzk4MCwianRpIjoiZTIzMDQwMmEtMzY2OC00OWRkLThlNmItNTIxYjhhM2JjYzIzIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYTMyNzVhZDMtYzMyZi00ODE3LTk4MTUtMmMzZmQ2YzQyYjkwIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImEzMjc1YWQzLWMzMmYtNDgxNy05ODE1LTJjM2ZkNmM0MmI5MCJ9.iektPJa0JGlmgxD9but9jt2SzZu3JteOlsk1TL-h8GU" "--context" "system-tests"
[2021-09-16T15:59:41Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgyODEsImlhdCI6MTYzMTgwNzk4MSwiYXV0aF90aW1lIjoxNjMxODA3OTc4LCJqdGkiOiJiYWI0NTNkOC1jMDE0LTQyOGYtODAxOC1kNWI2ZjE5ZmIxOWIiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImEzMjc1YWQzLWMzMmYtNDgxNy05ODE1LTJjM2ZkNmM0MmI5MCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJhMzI3NWFkMy1jMzJmLTQ4MTctOTgxNS0yYzNmZDZjNDJiOTAiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.f5utEw2gk5_rClAcu6KBE13QROE2i_KHLmo4wBe-BygNVc1y-SeewuNwtUCbpW-OcTZkFo-cVW00GeigKjZNzugoxRw18F0hT5SAm-e3hZVD1Dz0PoELFPI7ChCK52Zo6ZkvKsD1py8sfTFhtqdq4pvThymbtcpV17Rd9xRQG9esUFhsHFVAwUKOwcwpGkQr7u3-LloqA_vgTvofoVmu7_enYrfUw8SI_pseT9gpy-vGnr-UGL0qNmyGtAYkpD6GKmqyuvksjCWbr-bzD4Nl6wTI9ViuteIkOJRuLXB7YZQ-kyMzCO1Gx2dqitZBUIhC62dEkIl3CKNfNWGwcabccw\n", stderr: "" })
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::resources::apps] Create application: ab265791-d381-4179-84fc-08f35153dcbf
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "ab265791-d381-4179-84fc-08f35153dcbf"
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App ab265791-d381-4179-84fc-08f35153dcbf created.\n", stderr: "" })
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "ab265791-d381-4179-84fc-08f35153dcbf"
[2021-09-16T15:59:42Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:59:42.068429Z\",\n    \"generation\": 1,\n    \"name\": \"ab265791-d381-4179-84fc-08f35153dcbf\",\n    \"resourceVersion\": \"280acd7b-ad0b-4389-8fba-437427f1c769\",\n    \"uid\": \"cfe99efa-cead-4673-9dce-997a4574697d\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:59:42.083873431Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ]\n  }\n}", stderr: "" })
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "ab265791-d381-4179-84fc-08f35153dcbf"
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:59:42.068429Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"ab265791-d381-4179-84fc-08f35153dcbf\",\n    \"resourceVersion\": \"85851960-4a8b-420d-9280-2fe8bee46a82\",\n    \"uid\": \"cfe99efa-cead-4673-9dce-997a4574697d\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:59:42.702856230Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:59:42.702823079Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.140672501Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.146806721Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.369751855Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.396582016Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.702793664Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.702795807Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ZqHwvntyKBZR\",\n        \"username\": \"user-ab265791-d381-4179-84fc-08f35153dcbf\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "ab265791-d381-4179-84fc-08f35153dcbf"
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T15:59:42.068429Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"ab265791-d381-4179-84fc-08f35153dcbf\",\n    \"resourceVersion\": \"85851960-4a8b-420d-9280-2fe8bee46a82\",\n    \"uid\": \"cfe99efa-cead-4673-9dce-997a4574697d\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:59:42.702856230Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T15:59:42.702823079Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.140672501Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.146806721Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.369751855Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.396582016Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.702793664Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T15:59:42.702795807Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ZqHwvntyKBZR\",\n        \"username\": \"user-ab265791-d381-4179-84fc-08f35153dcbf\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "ab265791-d381-4179-84fc-08f35153dcbf" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgyODEsImlhdCI6MTYzMTgwNzk4MSwiYXV0aF90aW1lIjoxNjMxODA3OTc4LCJqdGkiOiJiYWI0NTNkOC1jMDE0LTQyOGYtODAxOC1kNWI2ZjE5ZmIxOWIiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImEzMjc1YWQzLWMzMmYtNDgxNy05ODE1LTJjM2ZkNmM0MmI5MCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJhMzI3NWFkMy1jMzJmLTQ4MTctOTgxNS0yYzNmZDZjNDJiOTAiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.f5utEw2gk5_rClAcu6KBE13QROE2i_KHLmo4wBe-BygNVc1y-SeewuNwtUCbpW-OcTZkFo-cVW00GeigKjZNzugoxRw18F0hT5SAm-e3hZVD1Dz0PoELFPI7ChCK52Zo6ZkvKsD1py8sfTFhtqdq4pvThymbtcpV17Rd9xRQG9esUFhsHFVAwUKOwcwpGkQr7u3-LloqA_vgTvofoVmu7_enYrfUw8SI_pseT9gpy-vGnr-UGL0qNmyGtAYkpD6GKmqyuvksjCWbr-bzD4Nl6wTI9ViuteIkOJRuLXB7YZQ-kyMzCO1Gx2dqitZBUIhC62dEkIl3CKNfNWGwcabccw\n", stderr: "" })
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:59:43Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:59:45Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:59:45Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:59:46Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:59:46Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:59:47Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T15:59:47Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T15:59:47Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0080016c00, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } }, data: MessageData { topic: "app/ab265791-d381-4179-84fc-08f35153dcbf", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 56, 99, 49, 102, 100, 56, 50, 54, 45, 101, 48, 102, 53, 45, 52, 51, 49, 102, 45, 97, 55, 100, 55, 45, 102, 51, 57, 99, 49, 100, 49, 52, 100, 100, 57, 99, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 97, 98, 50, 54, 53, 55, 57, 49, 37, 50, 68, 100, 51, 56, 49, 37, 50, 68, 52, 49, 55, 57, 37, 50, 68, 56, 52, 102, 99, 37, 50, 68, 48, 56, 102, 51, 53, 49, 53, 51, 100, 99, 98, 102, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 53, 58, 53, 57, 58, 52, 55, 46, 50, 49, 51, 55, 49, 53, 53, 48, 49, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 97, 98, 50, 54, 53, 55, 57, 49, 45, 100, 51, 56, 49, 45, 52, 49, 55, 57, 45, 56, 52, 102, 99, 45, 48, 56, 102, 51, 53, 49, 53, 51, 100, 99, 98, 102, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 97, 98, 50, 54, 53, 55, 57, 49, 37, 50, 68, 100, 51, 56, 49, 37, 50, 68, 52, 49, 55, 57, 37, 50, 68, 56, 52, 102, 99, 37, 50, 68, 48, 56, 102, 51, 53, 49, 53, 51, 100, 99, 98, 102, 47, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } } } }
[2021-09-16T15:59:47Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/ab265791-d381-4179-84fc-08f35153dcbf", content_type: Some("application/cloudevents+json; charset=utf-8"), user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"8c1fd826-e0f5-431f-a7d7-f39c1d14dd9c\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://ab265791%2Dd381%2D4179%2D84fc%2D08f35153dcbf/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T15:59:47.213715501Z\",\"data\":{\"index\":3},\"application\":\"ab265791-d381-4179-84fc-08f35153dcbf\",\"instance\":\"drogue\",\"device\":\"device1\",\"partitionkey\":\"ab265791%2Dd381%2D4179%2D84fc%2D08f35153dcbf/device1\"}" }
[2021-09-16T15:59:48Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T15:59:48Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T15:59:48Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    71,
                    70,
                    105,
                    77,
                    106,
                    89,
                    49,
                    78,
                    122,
                    107,
                    120,
                    76,
                    87,
                    81,
                    122,
                    79,
                    68,
                    69,
                    116,
                    78,
                    68,
                    69,
                    51,
                    79,
                    83,
                    48,
                    52,
                    78,
                    71,
                    90,
                    106,
                    76,
                    84,
                    65,
                    52,
                    90,
                    106,
                    77,
                    49,
                    77,
                    84,
                    85,
                    122,
                    90,
                    71,
                    78,
                    105,
                    90,
                    106,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:00:23Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:00:23Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "ab265791-d381-4179-84fc-08f35153dcbf" "device1"
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::resources::apps] Destroy application 'ab265791-d381-4179-84fc-08f35153dcbf'
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "ab265791-d381-4179-84fc-08f35153dcbf"
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App ab265791-d381-4179-84fc-08f35153dcbf deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user::version_3

**Duration**: 52.425933547s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:00:24Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:00:27Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:00:32Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk4MzIsImlhdCI6MTYzMTgwODAzMiwianRpIjoiNTdmYzI4NjYtZDA3MS00ZDkzLWE2YzItY2M4ZjAyMjZmZGQ3IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYjg3MzY0ZWYtY2EzMC00ODEwLTk0OWMtZTg4MTJlMmQzZjVmIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImI4NzM2NGVmLWNhMzAtNDgxMC05NDljLWU4ODEyZTJkM2Y1ZiJ9.VgpgjUmfSgF0wLNWmJx7tDFex9vbGMWacgbwM1U6v0E
[2021-09-16T16:00:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:00:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:00:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk4MzIsImlhdCI6MTYzMTgwODAzMiwianRpIjoiNTdmYzI4NjYtZDA3MS00ZDkzLWE2YzItY2M4ZjAyMjZmZGQ3IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYjg3MzY0ZWYtY2EzMC00ODEwLTk0OWMtZTg4MTJlMmQzZjVmIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImI4NzM2NGVmLWNhMzAtNDgxMC05NDljLWU4ODEyZTJkM2Y1ZiJ9.VgpgjUmfSgF0wLNWmJx7tDFex9vbGMWacgbwM1U6v0E" "--context" "system-tests"
[2021-09-16T16:00:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgzMzIsImlhdCI6MTYzMTgwODAzMiwiYXV0aF90aW1lIjoxNjMxODA4MDI5LCJqdGkiOiJkZWUwNWU4Yi1kMjY5LTQxYjctYTE1MS1mZjBjMGZiNjUyYzQiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImI4NzM2NGVmLWNhMzAtNDgxMC05NDljLWU4ODEyZTJkM2Y1ZiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJiODczNjRlZi1jYTMwLTQ4MTAtOTQ5Yy1lODgxMmUyZDNmNWYiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.X0tsRvxzTbdolWIRvJTzKr2mwsUXMBaaO4Elzkj3pV1v7hvgA6xL8aFojXMckSBaQrDRizZhUuWG4lGNsTERitmgYAMYZYgTRHRxnuwD8rRykqwWmSVIOAMxH5Rc06NOKXl2DY3xAb0teXV8LaMrrQH_wXxXN71aB8H_4v6aK5FiBrvKLnL4Ll_J9cF-FwhlrXWM6uMkfHaNxzpKFvKDeUyX0FU1ZUIydpAchOHDbhyHWnUtQq1b1PUTnWVzqOgtOJLWQw-w7KyWfyJUT31gyJojzv9xWDpITDJRHnIIKkeFs2OEUR2ZYs_94r62_pVdz1UNDBmBenEFzOwCC0E54w\n", stderr: "" })
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::resources::apps] Create application: 59edce40-9650-472f-bfc3-b720ec78e927
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "59edce40-9650-472f-bfc3-b720ec78e927"
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 59edce40-9650-472f-bfc3-b720ec78e927 created.\n", stderr: "" })
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "59edce40-9650-472f-bfc3-b720ec78e927"
[2021-09-16T16:00:33Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:00:33.411404Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 2,\n    \"name\": \"59edce40-9650-472f-bfc3-b720ec78e927\",\n    \"resourceVersion\": \"60977b2d-aacb-458b-850f-fb3e1d18bfd6\",\n    \"uid\": \"669f40fc-b5a2-4f2c-894a-1c70d018f969\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.432440386Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.432427131Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432402065Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432403027Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432403497Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432404128Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432404569Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.432405982Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 1\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "59edce40-9650-472f-bfc3-b720ec78e927"
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:00:33.411404Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"59edce40-9650-472f-bfc3-b720ec78e927\",\n    \"resourceVersion\": \"1e372208-b79b-4854-82d3-4afdbb542f3e\",\n    \"uid\": \"669f40fc-b5a2-4f2c-894a-1c70d018f969\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.869662366Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.869637420Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.463603100Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.473022425Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.654226775Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.664816738Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.869617743Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.869619476Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"v5cyhCCJnISF\",\n        \"username\": \"user-59edce40-9650-472f-bfc3-b720ec78e927\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "59edce40-9650-472f-bfc3-b720ec78e927"
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:00:33.411404Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"59edce40-9650-472f-bfc3-b720ec78e927\",\n    \"resourceVersion\": \"1e372208-b79b-4854-82d3-4afdbb542f3e\",\n    \"uid\": \"669f40fc-b5a2-4f2c-894a-1c70d018f969\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.869662366Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:00:33.869637420Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.463603100Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.473022425Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.654226775Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.664816738Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.869617743Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:00:33.869619476Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"v5cyhCCJnISF\",\n        \"username\": \"user-59edce40-9650-472f-bfc3-b720ec78e927\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "59edce40-9650-472f-bfc3-b720ec78e927" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgzMzIsImlhdCI6MTYzMTgwODAzMiwiYXV0aF90aW1lIjoxNjMxODA4MDI5LCJqdGkiOiJkZWUwNWU4Yi1kMjY5LTQxYjctYTE1MS1mZjBjMGZiNjUyYzQiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImI4NzM2NGVmLWNhMzAtNDgxMC05NDljLWU4ODEyZTJkM2Y1ZiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJiODczNjRlZi1jYTMwLTQ4MTAtOTQ5Yy1lODgxMmUyZDNmNWYiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.X0tsRvxzTbdolWIRvJTzKr2mwsUXMBaaO4Elzkj3pV1v7hvgA6xL8aFojXMckSBaQrDRizZhUuWG4lGNsTERitmgYAMYZYgTRHRxnuwD8rRykqwWmSVIOAMxH5Rc06NOKXl2DY3xAb0teXV8LaMrrQH_wXxXN71aB8H_4v6aK5FiBrvKLnL4Ll_J9cF-FwhlrXWM6uMkfHaNxzpKFvKDeUyX0FU1ZUIydpAchOHDbhyHWnUtQq1b1PUTnWVzqOgtOJLWQw-w7KyWfyJUT31gyJojzv9xWDpITDJRHnIIKkeFs2OEUR2ZYs_94r62_pVdz1UNDBmBenEFzOwCC0E54w\n", stderr: "" })
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:34Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:00:36Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:36Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:00:37Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:37Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:00:38Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:38Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:00:39Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:00:39Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:00:39Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 11, payload: 0x7f00740160d0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432f6e10 } }, data: MessageData { topic: "app/59edce40-9650-472f-bfc3-b720ec78e927", payload: [123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125], props: Properties { cprops: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432f6e10 } } } }
[2021-09-16T16:00:39Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/59edce40-9650-472f-bfc3-b720ec78e927", content_type: Some("application/json"), user_properties: {"time": "2021-09-16T16:00:39.272579233+00:00", "specversion": "1.0", "application": "59edce40-9650-472f-bfc3-b720ec78e927", "subject": "warmup", "partitionkey": "59edce40%2D9650%2D472f%2Dbfc3%2Db720ec78e927/device1", "device": "device1", "type": "io.drogue.event.v1", "source": "drogue://59edce40%2D9650%2D472f%2Dbfc3%2Db720ec78e927/device1", "id": "8ea599a0-971f-45b7-a1eb-a9833253b8a1", "instance": "drogue"}, payload: "{\"index\":4}" }
[2021-09-16T16:00:40Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T16:00:40Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:00:40Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    68,
                    85,
                    53,
                    90,
                    87,
                    82,
                    106,
                    90,
                    84,
                    81,
                    119,
                    76,
                    84,
                    107,
                    50,
                    78,
                    84,
                    65,
                    116,
                    78,
                    68,
                    99,
                    121,
                    90,
                    105,
                    49,
                    105,
                    90,
                    109,
                    77,
                    122,
                    76,
                    87,
                    73,
                    51,
                    77,
                    106,
                    66,
                    108,
                    89,
                    122,
                    99,
                    52,
                    90,
                    84,
                    107,
                    121,
                    78,
                    122,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:01:17Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "59edce40-9650-472f-bfc3-b720ec78e927" "device1"
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::resources::apps] Destroy application '59edce40-9650-472f-bfc3-b720ec78e927'
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "59edce40-9650-472f-bfc3-b720ec78e927"
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 59edce40-9650-472f-bfc3-b720ec78e927 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_alias::version_1

**Duration**: 49.858782735s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:01:17Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:01:19Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk4ODMsImlhdCI6MTYzMTgwODA4MywianRpIjoiNWU3YTE5NjQtZjlmOS00MjQ1LTgwNTktMWI1ZTM0Nzc4MjA5IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYjE3ODllZGMtMWJhNS00MmZmLTkwNTItMzhjZWY1NDUzNjVkIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImIxNzg5ZWRjLTFiYTUtNDJmZi05MDUyLTM4Y2VmNTQ1MzY1ZCJ9.0JLnebexmVqryfRPdtNhmsycXveosg4lcHGJec3pJXE
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk4ODMsImlhdCI6MTYzMTgwODA4MywianRpIjoiNWU3YTE5NjQtZjlmOS00MjQ1LTgwNTktMWI1ZTM0Nzc4MjA5IiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiYjE3ODllZGMtMWJhNS00MmZmLTkwNTItMzhjZWY1NDUzNjVkIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImIxNzg5ZWRjLTFiYTUtNDJmZi05MDUyLTM4Y2VmNTQ1MzY1ZCJ9.0JLnebexmVqryfRPdtNhmsycXveosg4lcHGJec3pJXE" "--context" "system-tests"
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgzODMsImlhdCI6MTYzMTgwODA4MywiYXV0aF90aW1lIjoxNjMxODA4MDgwLCJqdGkiOiIxOWRkMDRkMC01OWY1LTQ3YmEtYjM4Ny02MzlhZGU1MTdkZDMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImIxNzg5ZWRjLTFiYTUtNDJmZi05MDUyLTM4Y2VmNTQ1MzY1ZCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJiMTc4OWVkYy0xYmE1LTQyZmYtOTA1Mi0zOGNlZjU0NTM2NWQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.IQdrypshiSoVV49Um2HrDoSK14pvwepE8kUE7i3-j9FYUOCUdIF0oW1JnTG9N58lVUwBuj_J5UNpPUr51GQZywAnJOgQheHC2dv9WdYZPUyvoYMjHvH1nCCW6GN6BZGoVNfV6bVVirZW2dNDx_K3cBtsgPIsdPiHZ_WSv4AVRtbVvQ0oSIoqwTRvjWPKIM-sUoTv5SgRZ2Fu43Rdd0o1xNQXDhlUwQFLEDPlBkj8o0-2XDom8FOd5ifqnG4zvuVUxKeTpWuCVQfVhaEd3kbdB2NlLji2J2ZbD_xDWcfXOHFY5kC3nTYSrTB_KUBXga-3fJ2THmMhN6Ch-0dUlHvQxg\n", stderr: "" })
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::resources::apps] Create application: 9a34b1e3-39b9-405f-aac0-a54c753e745e
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "9a34b1e3-39b9-405f-aac0-a54c753e745e"
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 9a34b1e3-39b9-405f-aac0-a54c753e745e created.\n", stderr: "" })
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "9a34b1e3-39b9-405f-aac0-a54c753e745e"
[2021-09-16T16:01:23Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:01:23.939375Z\",\n    \"generation\": 1,\n    \"name\": \"9a34b1e3-39b9-405f-aac0-a54c753e745e\",\n    \"resourceVersion\": \"df6204be-4fab-49c5-900b-8e98b4ee4812\",\n    \"uid\": \"5417d121-4fad-4bd3-b84c-51ab0a08b90c\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:01:23.953735466Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ]\n  }\n}", stderr: "" })
[2021-09-16T16:01:24Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "9a34b1e3-39b9-405f-aac0-a54c753e745e"
[2021-09-16T16:01:24Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:01:23.939375Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"9a34b1e3-39b9-405f-aac0-a54c753e745e\",\n    \"resourceVersion\": \"c9720075-406d-4b95-9e17-cde9c57f2428\",\n    \"uid\": \"5417d121-4fad-4bd3-b84c-51ab0a08b90c\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:01:24.335358662Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:01:24.335317265Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:23.995851079Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.001416964Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.082206068Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.090877160Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.335293130Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.335295123Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"q62AgwCYEiXw\",\n        \"username\": \"user-9a34b1e3-39b9-405f-aac0-a54c753e745e\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:01:24Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "9a34b1e3-39b9-405f-aac0-a54c753e745e"
[2021-09-16T16:01:24Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:01:23.939375Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"9a34b1e3-39b9-405f-aac0-a54c753e745e\",\n    \"resourceVersion\": \"c9720075-406d-4b95-9e17-cde9c57f2428\",\n    \"uid\": \"5417d121-4fad-4bd3-b84c-51ab0a08b90c\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:01:24.335358662Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:01:24.335317265Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:23.995851079Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.001416964Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.082206068Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.090877160Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.335293130Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:01:24.335295123Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"q62AgwCYEiXw\",\n        \"username\": \"user-9a34b1e3-39b9-405f-aac0-a54c753e745e\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "9a34b1e3-39b9-405f-aac0-a54c753e745e" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"unique\":true,\"username\":\"foo\"}}]}}"
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDgzODMsImlhdCI6MTYzMTgwODA4MywiYXV0aF90aW1lIjoxNjMxODA4MDgwLCJqdGkiOiIxOWRkMDRkMC01OWY1LTQ3YmEtYjM4Ny02MzlhZGU1MTdkZDMiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImIxNzg5ZWRjLTFiYTUtNDJmZi05MDUyLTM4Y2VmNTQ1MzY1ZCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJiMTc4OWVkYy0xYmE1LTQyZmYtOTA1Mi0zOGNlZjU0NTM2NWQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.IQdrypshiSoVV49Um2HrDoSK14pvwepE8kUE7i3-j9FYUOCUdIF0oW1JnTG9N58lVUwBuj_J5UNpPUr51GQZywAnJOgQheHC2dv9WdYZPUyvoYMjHvH1nCCW6GN6BZGoVNfV6bVVirZW2dNDx_K3cBtsgPIsdPiHZ_WSv4AVRtbVvQ0oSIoqwTRvjWPKIM-sUoTv5SgRZ2Fu43Rdd0o1xNQXDhlUwQFLEDPlBkj8o0-2XDom8FOd5ifqnG4zvuVUxKeTpWuCVQfVhaEd3kbdB2NlLji2J2ZbD_xDWcfXOHFY5kC3nTYSrTB_KUBXga-3fJ2THmMhN6Ch-0dUlHvQxg\n", stderr: "" })
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:25Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:01:26Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:26Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:01:27Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:27Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:01:28Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:28Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:01:29Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:01:29Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:01:29Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f00780132c0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/9a34b1e3-39b9-405f-aac0-a54c753e745e", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 50, 48, 51, 99, 100, 98, 48, 101, 45, 56, 48, 54, 53, 45, 52, 49, 102, 100, 45, 56, 97, 48, 53, 45, 52, 101, 53, 98, 102, 56, 52, 51, 54, 51, 49, 48, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 57, 97, 51, 52, 98, 49, 101, 51, 37, 50, 68, 51, 57, 98, 57, 37, 50, 68, 52, 48, 53, 102, 37, 50, 68, 97, 97, 99, 48, 37, 50, 68, 97, 53, 52, 99, 55, 53, 51, 101, 55, 52, 53, 101, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 54, 58, 48, 49, 58, 50, 57, 46, 51, 49, 54, 54, 57, 57, 52, 52, 55, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 57, 97, 51, 52, 98, 49, 101, 51, 37, 50, 68, 51, 57, 98, 57, 37, 50, 68, 52, 48, 53, 102, 37, 50, 68, 97, 97, 99, 48, 37, 50, 68, 97, 53, 52, 99, 55, 53, 51, 101, 55, 52, 53, 101, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 57, 97, 51, 52, 98, 49, 101, 51, 45, 51, 57, 98, 57, 45, 52, 48, 53, 102, 45, 97, 97, 99, 48, 45, 97, 53, 52, 99, 55, 53, 51, 101, 55, 52, 53, 101, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T16:01:29Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/9a34b1e3-39b9-405f-aac0-a54c753e745e", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"203cdb0e-8065-41fd-8a05-4e5bf8436310\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://9a34b1e3%2D39b9%2D405f%2Daac0%2Da54c753e745e/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T16:01:29.316699447Z\",\"data\":{\"index\":4},\"device\":\"device1\",\"partitionkey\":\"9a34b1e3%2D39b9%2D405f%2Daac0%2Da54c753e745e/device1\",\"application\":\"9a34b1e3-39b9-405f-aac0-a54c753e745e\",\"instance\":\"drogue\"}" }
[2021-09-16T16:01:30Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T16:01:30Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:01:30Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    68,
                    108,
                    104,
                    77,
                    122,
                    82,
                    105,
                    77,
                    87,
                    85,
                    122,
                    76,
                    84,
                    77,
                    53,
                    89,
                    106,
                    107,
                    116,
                    78,
                    68,
                    65,
                    49,
                    90,
                    105,
                    49,
                    104,
                    89,
                    87,
                    77,
                    119,
                    76,
                    87,
                    69,
                    49,
                    78,
                    71,
                    77,
                    51,
                    78,
                    84,
                    78,
                    108,
                    78,
                    122,
                    81,
                    49,
                    90,
                    84,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:02:06Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "9a34b1e3-39b9-405f-aac0-a54c753e745e" "device1"
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::resources::apps] Destroy application '9a34b1e3-39b9-405f-aac0-a54c753e745e'
[2021-09-16T16:02:06Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "9a34b1e3-39b9-405f-aac0-a54c753e745e"
[2021-09-16T16:02:07Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 9a34b1e3-39b9-405f-aac0-a54c753e745e deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_alias::version_2

**Duration**: 49.051480669s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:02:07Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:02:09Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk5MzIsImlhdCI6MTYzMTgwODEzMiwianRpIjoiNWVjMTFhYWItZDMyYS00ZTNjLThmYzgtOTYyZDdlYWNmODJiIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOWNiOGQ2YTAtNmZiMi00YWQ3LWI5NGYtZjgzOTQ0NmRlMDc0Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjljYjhkNmEwLTZmYjItNGFkNy1iOTRmLWY4Mzk0NDZkZTA3NCJ9.k4qkJgrfQwS9joD-kMiacZFUfwvVT3FqIuTeNa0CSuY
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk5MzIsImlhdCI6MTYzMTgwODEzMiwianRpIjoiNWVjMTFhYWItZDMyYS00ZTNjLThmYzgtOTYyZDdlYWNmODJiIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOWNiOGQ2YTAtNmZiMi00YWQ3LWI5NGYtZjgzOTQ0NmRlMDc0Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjljYjhkNmEwLTZmYjItNGFkNy1iOTRmLWY4Mzk0NDZkZTA3NCJ9.k4qkJgrfQwS9joD-kMiacZFUfwvVT3FqIuTeNa0CSuY" "--context" "system-tests"
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg0MzMsImlhdCI6MTYzMTgwODEzMywiYXV0aF90aW1lIjoxNjMxODA4MTMwLCJqdGkiOiIwYmM5NjJkMy1lYjgzLTRmNGUtYWViOC00M2IxZWZlY2EyMWEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjljYjhkNmEwLTZmYjItNGFkNy1iOTRmLWY4Mzk0NDZkZTA3NCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI5Y2I4ZDZhMC02ZmIyLTRhZDctYjk0Zi1mODM5NDQ2ZGUwNzQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.NgZcYWVB9KlE1Vb4PGviUViX5mAtDjmFITr9hNsC99yxqMBCIkDue1EN8Nx8nVn09IU0Uv2xlP4AiTS7wRtOD01TaINduARcbj9DhTcmZ-xAbjKj8Zdv5eqhZ96SG2W9PKnc_FEb0HiQvrUC6rltpVnMciWJU8P5tvdC-XbJFbos_kh4AFsnh7Cd4GFXqnGLoAjhQRky--3IOku4C6gN-wR2yKWKhD-9-y2JRkbmq0VW7_OLIiPmSS2gKPhd_YLkAaZOl_QcSLzvXmoFlMeGSLXqp8uH2jAtdFEffsm_EwBlV0TbhVUeYZ0XICBYridV2lNe0KqFEWdw23V90nkkHQ\n", stderr: "" })
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::resources::apps] Create application: 6025b4cf-24e2-43f8-9cc3-8e014fe665ea
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea"
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6025b4cf-24e2-43f8-9cc3-8e014fe665ea created.\n", stderr: "" })
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea"
[2021-09-16T16:02:13Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:02:13.871910Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"6025b4cf-24e2-43f8-9cc3-8e014fe665ea\",\n    \"resourceVersion\": \"5953f927-2588-4baa-955c-3f7bf2998dd5\",\n    \"uid\": \"85bda205-e101-4acd-86d6-ff7b0cbc0634\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:13.884848276Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:13.884861100Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884824752Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884826816Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884827658Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884828509Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884828830Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.884830974Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea"
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:02:13.871910Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"6025b4cf-24e2-43f8-9cc3-8e014fe665ea\",\n    \"resourceVersion\": \"f3e12c67-bd51-48bd-bd7a-6bc1b6d7dac0\",\n    \"uid\": \"85bda205-e101-4acd-86d6-ff7b0cbc0634\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:14.202637896Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:14.202661370Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.912122987Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.918392076Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.025144690Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.047145049Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.202618019Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.202619932Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"JHedZtllC2h2\",\n        \"username\": \"user-6025b4cf-24e2-43f8-9cc3-8e014fe665ea\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea"
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:02:13.871910Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"6025b4cf-24e2-43f8-9cc3-8e014fe665ea\",\n    \"resourceVersion\": \"f3e12c67-bd51-48bd-bd7a-6bc1b6d7dac0\",\n    \"uid\": \"85bda205-e101-4acd-86d6-ff7b0cbc0634\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:14.202637896Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:02:14.202661370Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.912122987Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:13.918392076Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.025144690Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.047145049Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.202618019Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:02:14.202619932Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"JHedZtllC2h2\",\n        \"username\": \"user-6025b4cf-24e2-43f8-9cc3-8e014fe665ea\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"unique\":true,\"username\":\"foo\"}}]}}"
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg0MzMsImlhdCI6MTYzMTgwODEzMywiYXV0aF90aW1lIjoxNjMxODA4MTMwLCJqdGkiOiIwYmM5NjJkMy1lYjgzLTRmNGUtYWViOC00M2IxZWZlY2EyMWEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjljYjhkNmEwLTZmYjItNGFkNy1iOTRmLWY4Mzk0NDZkZTA3NCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI5Y2I4ZDZhMC02ZmIyLTRhZDctYjk0Zi1mODM5NDQ2ZGUwNzQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.NgZcYWVB9KlE1Vb4PGviUViX5mAtDjmFITr9hNsC99yxqMBCIkDue1EN8Nx8nVn09IU0Uv2xlP4AiTS7wRtOD01TaINduARcbj9DhTcmZ-xAbjKj8Zdv5eqhZ96SG2W9PKnc_FEb0HiQvrUC6rltpVnMciWJU8P5tvdC-XbJFbos_kh4AFsnh7Cd4GFXqnGLoAjhQRky--3IOku4C6gN-wR2yKWKhD-9-y2JRkbmq0VW7_OLIiPmSS2gKPhd_YLkAaZOl_QcSLzvXmoFlMeGSLXqp8uH2jAtdFEffsm_EwBlV0TbhVUeYZ0XICBYridV2lNe0KqFEWdw23V90nkkHQ\n", stderr: "" })
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:02:14Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:02:16Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:02:16Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:02:17Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:02:17Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:02:18Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:02:18Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:02:18Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0080016c00, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } }, data: MessageData { topic: "app/6025b4cf-24e2-43f8-9cc3-8e014fe665ea", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 53, 101, 54, 50, 48, 100, 51, 102, 45, 55, 99, 101, 55, 45, 52, 102, 98, 102, 45, 98, 102, 51, 101, 45, 102, 55, 50, 100, 57, 52, 56, 57, 102, 49, 57, 50, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 54, 48, 50, 53, 98, 52, 99, 102, 37, 50, 68, 50, 52, 101, 50, 37, 50, 68, 52, 51, 102, 56, 37, 50, 68, 57, 99, 99, 51, 37, 50, 68, 56, 101, 48, 49, 52, 102, 101, 54, 54, 53, 101, 97, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 54, 58, 48, 50, 58, 49, 56, 46, 50, 57, 52, 52, 52, 55, 55, 52, 50, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 54, 48, 50, 53, 98, 52, 99, 102, 37, 50, 68, 50, 52, 101, 50, 37, 50, 68, 52, 51, 102, 56, 37, 50, 68, 57, 99, 99, 51, 37, 50, 68, 56, 101, 48, 49, 52, 102, 101, 54, 54, 53, 101, 97, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 54, 48, 50, 53, 98, 52, 99, 102, 45, 50, 52, 101, 50, 45, 52, 51, 102, 56, 45, 57, 99, 99, 51, 45, 56, 101, 48, 49, 52, 102, 101, 54, 54, 53, 101, 97, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 125], props: Properties { cprops: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } } } }
[2021-09-16T16:02:18Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/6025b4cf-24e2-43f8-9cc3-8e014fe665ea", content_type: Some("application/cloudevents+json; charset=utf-8"), user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"5e620d3f-7ce7-4fbf-bf3e-f72d9489f192\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://6025b4cf%2D24e2%2D43f8%2D9cc3%2D8e014fe665ea/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T16:02:18.294447742Z\",\"data\":{\"index\":3},\"device\":\"device1\",\"partitionkey\":\"6025b4cf%2D24e2%2D43f8%2D9cc3%2D8e014fe665ea/device1\",\"application\":\"6025b4cf-24e2-43f8-9cc3-8e014fe665ea\",\"instance\":\"drogue\"}" }
[2021-09-16T16:02:19Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T16:02:19Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:02:19Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    68,
                    89,
                    119,
                    77,
                    106,
                    86,
                    105,
                    78,
                    71,
                    78,
                    109,
                    76,
                    84,
                    73,
                    48,
                    90,
                    84,
                    73,
                    116,
                    78,
                    68,
                    78,
                    109,
                    79,
                    67,
                    48,
                    53,
                    89,
                    50,
                    77,
                    122,
                    76,
                    84,
                    104,
                    108,
                    77,
                    68,
                    69,
                    48,
                    90,
                    109,
                    85,
                    50,
                    78,
                    106,
                    86,
                    108,
                    89,
                    84,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:02:55Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:02:55Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea" "device1"
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::resources::apps] Destroy application '6025b4cf-24e2-43f8-9cc3-8e014fe665ea'
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "6025b4cf-24e2-43f8-9cc3-8e014fe665ea"
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6025b4cf-24e2-43f8-9cc3-8e014fe665ea deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_alias::version_3

**Duration**: 50.696858724s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:02:56Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:02:58Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:03:02Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk5ODIsImlhdCI6MTYzMTgwODE4MiwianRpIjoiYjYxZTg1ZTUtMWM3NS00MGM1LWFiOWQtMGYzMjk0NjU1YjVhIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiY2ViOWE4YjYtYWRlYi00OWRjLThkNzAtOWVmZDkxZmM5MzgxIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImNlYjlhOGI2LWFkZWItNDlkYy04ZDcwLTllZmQ5MWZjOTM4MSJ9.K9VWDVrh1nT1nTgK0SzuL6z_2nQtPfS57shLGORkCTA
[2021-09-16T16:03:02Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:03:02Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:03:02Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MDk5ODIsImlhdCI6MTYzMTgwODE4MiwianRpIjoiYjYxZTg1ZTUtMWM3NS00MGM1LWFiOWQtMGYzMjk0NjU1YjVhIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiY2ViOWE4YjYtYWRlYi00OWRjLThkNzAtOWVmZDkxZmM5MzgxIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6ImNlYjlhOGI2LWFkZWItNDlkYy04ZDcwLTllZmQ5MWZjOTM4MSJ9.K9VWDVrh1nT1nTgK0SzuL6z_2nQtPfS57shLGORkCTA" "--context" "system-tests"
[2021-09-16T16:03:02Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg0ODIsImlhdCI6MTYzMTgwODE4MiwiYXV0aF90aW1lIjoxNjMxODA4MTc5LCJqdGkiOiI5NjUwNGM1ZS0wZTAzLTQwZGEtYjU4Ni1lODNmNzFiMmQ4YzkiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImNlYjlhOGI2LWFkZWItNDlkYy04ZDcwLTllZmQ5MWZjOTM4MSIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJjZWI5YThiNi1hZGViLTQ5ZGMtOGQ3MC05ZWZkOTFmYzkzODEiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.e7N1J7lD-n0fYk6axjd9t6TOaII7Zd0lrRylVQLa_1Vk31mRmx9MEACHUfGdHEEWNJqHt8wmdyBh4m65LA7IwXM8wdWU6UlGx3COQgO-Pa7Qtfs7mpVUx5aWEthBmXDLcLqqu_6TkNvwdGCBCj8PQYly_NPElL4jdLA71WO88ViV3lgdmHtv8h6TwLG_kqiPRC3et13xtHJ-Etqby8TgJmJhIw937DYsMlFDwBQnVW4RVSjPLIDo9LvLaYsHBxVSpRWKPxGNcZG1l-im9dp8_rmwK36aQaGLe3WyBrAEF1alwnZqdFJ7sQDEPZHhL0R6bZv4UjOq-o31hawGHE7mIQ\n", stderr: "" })
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::resources::apps] Create application: e0722d2e-ef52-4d1d-ac1d-423d5b33da5a
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a"
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App e0722d2e-ef52-4d1d-ac1d-423d5b33da5a created.\n", stderr: "" })
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a"
[2021-09-16T16:03:03Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:03.107821Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 1,\n    \"name\": \"e0722d2e-ef52-4d1d-ac1d-423d5b33da5a\",\n    \"resourceVersion\": \"866180d7-5f3e-43ea-b1bc-bb60b6b7b2a1\",\n    \"uid\": \"255272a4-00c9-45b1-98db-321724726881\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.119516532Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.119529547Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119476076Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119477940Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119478621Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119479253Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119479583Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.119481877Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 0\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a"
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:03.107821Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"e0722d2e-ef52-4d1d-ac1d-423d5b33da5a\",\n    \"resourceVersion\": \"9dc07ba0-63a4-4c3e-9f76-8efc5d641924\",\n    \"uid\": \"255272a4-00c9-45b1-98db-321724726881\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.489010598Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.489051244Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.149260399Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.165536099Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.254875763Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.267128646Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.488987354Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.488989117Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"XyjgCpSw69df\",\n        \"username\": \"user-e0722d2e-ef52-4d1d-ac1d-423d5b33da5a\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a"
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:03.107821Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 8,\n    \"name\": \"e0722d2e-ef52-4d1d-ac1d-423d5b33da5a\",\n    \"resourceVersion\": \"9dc07ba0-63a4-4c3e-9f76-8efc5d641924\",\n    \"uid\": \"255272a4-00c9-45b1-98db-321724726881\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.489010598Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:03.489051244Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.149260399Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.165536099Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.254875763Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.267128646Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.488987354Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:03.488989117Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 7,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"XyjgCpSw69df\",\n        \"username\": \"user-e0722d2e-ef52-4d1d-ac1d-423d5b33da5a\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"unique\":true,\"username\":\"foo\"}}]}}"
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg0ODIsImlhdCI6MTYzMTgwODE4MiwiYXV0aF90aW1lIjoxNjMxODA4MTc5LCJqdGkiOiI5NjUwNGM1ZS0wZTAzLTQwZGEtYjU4Ni1lODNmNzFiMmQ4YzkiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6ImNlYjlhOGI2LWFkZWItNDlkYy04ZDcwLTllZmQ5MWZjOTM4MSIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiJjZWI5YThiNi1hZGViLTQ5ZGMtOGQ3MC05ZWZkOTFmYzkzODEiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.e7N1J7lD-n0fYk6axjd9t6TOaII7Zd0lrRylVQLa_1Vk31mRmx9MEACHUfGdHEEWNJqHt8wmdyBh4m65LA7IwXM8wdWU6UlGx3COQgO-Pa7Qtfs7mpVUx5aWEthBmXDLcLqqu_6TkNvwdGCBCj8PQYly_NPElL4jdLA71WO88ViV3lgdmHtv8h6TwLG_kqiPRC3et13xtHJ-Etqby8TgJmJhIw937DYsMlFDwBQnVW4RVSjPLIDo9LvLaYsHBxVSpRWKPxGNcZG1l-im9dp8_rmwK36aQaGLe3WyBrAEF1alwnZqdFJ7sQDEPZHhL0R6bZv4UjOq-o31hawGHE7mIQ\n", stderr: "" })
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:04Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:06Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:06Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:07Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:07Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:08Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:08Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:09Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:09Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:09Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 11, payload: 0x7f0078015330, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432da910 } }, data: MessageData { topic: "app/e0722d2e-ef52-4d1d-ac1d-423d5b33da5a", payload: [123, 34, 105, 110, 100, 101, 120, 34, 58, 52, 125], props: Properties { cprops: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432da910 } } } }
[2021-09-16T16:03:09Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/e0722d2e-ef52-4d1d-ac1d-423d5b33da5a", content_type: Some("application/json"), user_properties: {"time": "2021-09-16T16:03:09.339806571+00:00", "device": "device1", "id": "46e2b9f5-dd47-415c-8654-3142f65f9bbe", "application": "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a", "subject": "warmup", "source": "drogue://e0722d2e%2Def52%2D4d1d%2Dac1d%2D423d5b33da5a/device1", "specversion": "1.0", "partitionkey": "e0722d2e%2Def52%2D4d1d%2Dac1d%2D423d5b33da5a/device1", "type": "io.drogue.event.v1", "instance": "drogue"}, payload: "{\"index\":4}" }
[2021-09-16T16:03:10Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 4 attempts
[2021-09-16T16:03:10Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:03:10Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    81,
                    71,
                    85,
                    119,
                    78,
                    122,
                    73,
                    121,
                    90,
                    68,
                    74,
                    108,
                    76,
                    87,
                    86,
                    109,
                    78,
                    84,
                    73,
                    116,
                    78,
                    71,
                    81,
                    120,
                    90,
                    67,
                    49,
                    104,
                    89,
                    122,
                    70,
                    107,
                    76,
                    84,
                    81,
                    121,
                    77,
                    50,
                    81,
                    49,
                    89,
                    106,
                    77,
                    122,
                    90,
                    71,
                    69,
                    49,
                    89,
                    84,
                    112,
                    105,
                    89,
                    88,
                    73,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:03:46Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a" "device1"
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::resources::apps] Destroy application 'e0722d2e-ef52-4d1d-ac1d-423d5b33da5a'
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "e0722d2e-ef52-4d1d-ac1d-423d5b33da5a"
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App e0722d2e-ef52-4d1d-ac1d-423d5b33da5a deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_only::version_1

**Duration**: 49.55929897s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:03:46Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:03:48Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:03:52Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAwMzIsImlhdCI6MTYzMTgwODIzMiwianRpIjoiY2ZkODNjMDQtNjFkNy00ZThkLWFiYzYtYTFjZjc0ZjFiN2UzIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMDVkOWZkYzAtNGMyZC00MmNlLWEzZmItYjZjMDNiODFiNDE2Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjA1ZDlmZGMwLTRjMmQtNDJjZS1hM2ZiLWI2YzAzYjgxYjQxNiJ9._6ln_BWPK8FavVrfOtPqudV_EJS4Bqgu7aBEsSpCJPg
[2021-09-16T16:03:52Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:03:52Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:03:52Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAwMzIsImlhdCI6MTYzMTgwODIzMiwianRpIjoiY2ZkODNjMDQtNjFkNy00ZThkLWFiYzYtYTFjZjc0ZjFiN2UzIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMDVkOWZkYzAtNGMyZC00MmNlLWEzZmItYjZjMDNiODFiNDE2Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjA1ZDlmZGMwLTRjMmQtNDJjZS1hM2ZiLWI2YzAzYjgxYjQxNiJ9._6ln_BWPK8FavVrfOtPqudV_EJS4Bqgu7aBEsSpCJPg" "--context" "system-tests"
[2021-09-16T16:03:52Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg1MzIsImlhdCI6MTYzMTgwODIzMiwiYXV0aF90aW1lIjoxNjMxODA4MjMwLCJqdGkiOiI2ZDcyM2FkNy00MjM3LTQ1M2MtODJlZC02OTNjZmM5ZTYxMTciLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjA1ZDlmZGMwLTRjMmQtNDJjZS1hM2ZiLWI2YzAzYjgxYjQxNiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiIwNWQ5ZmRjMC00YzJkLTQyY2UtYTNmYi1iNmMwM2I4MWI0MTYiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.R_9Jc_mzkDg2IaLrQs_haJGlHOASCSxjO0rbZAjxD7cSQC9uqD8fUnZIy6ML9Xdu7kEIpxqq6hzbBtZ7GBtDDEPOp_yWx1Cmgi1Q_1685OMYXBpSh4LXUMgAT58klRP_HAcMm0lWLjYkssmC16W8tLM1RLYsWto6pDu9bo5EyAuwIS5uu2DcCi_jLhMvHCUDk3ptMl_r0qlcAxnmPP-BsqZWXWSTzSPHBtbx3n9bRsGCeCAxi96bpGhCck14h2w26wO-yUXcYRuzfIiv1skX1j_o0b9YFnwvAvJZ5p2lL_CA24W6UbdewgMfhSuGO1LR0HG2UIa7304LV6IIm1fWsw\n", stderr: "" })
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::resources::apps] Create application: 6c8d1682-5caa-4f91-a546-865ddf41cad6
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "6c8d1682-5caa-4f91-a546-865ddf41cad6"
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6c8d1682-5caa-4f91-a546-865ddf41cad6 created.\n", stderr: "" })
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6c8d1682-5caa-4f91-a546-865ddf41cad6"
[2021-09-16T16:03:53Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:53.464090Z\",\n    \"generation\": 0,\n    \"name\": \"6c8d1682-5caa-4f91-a546-865ddf41cad6\",\n    \"resourceVersion\": \"977b3bef-86b3-4719-9ec6-7d16a2644a8d\",\n    \"uid\": \"cbb4bcc9-189c-4fa6-8dec-2856e95cea9e\"\n  }\n}", stderr: "" })
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6c8d1682-5caa-4f91-a546-865ddf41cad6"
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:53.464090Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"6c8d1682-5caa-4f91-a546-865ddf41cad6\",\n    \"resourceVersion\": \"67ba747a-e4cd-42c9-8910-ed6dcf70a33c\",\n    \"uid\": \"cbb4bcc9-189c-4fa6-8dec-2856e95cea9e\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:53.758322301Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:53.758298084Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.516017652Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.522670503Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.609030515Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.614870547Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.758279169Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.758280512Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ol4pPe5jylQK\",\n        \"username\": \"user-6c8d1682-5caa-4f91-a546-865ddf41cad6\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "6c8d1682-5caa-4f91-a546-865ddf41cad6"
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:03:53.464090Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"6c8d1682-5caa-4f91-a546-865ddf41cad6\",\n    \"resourceVersion\": \"67ba747a-e4cd-42c9-8910-ed6dcf70a33c\",\n    \"uid\": \"cbb4bcc9-189c-4fa6-8dec-2856e95cea9e\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:53.758322301Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:03:53.758298084Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.516017652Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.522670503Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.609030515Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.614870547Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.758279169Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:03:53.758280512Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"ol4pPe5jylQK\",\n        \"username\": \"user-6c8d1682-5caa-4f91-a546-865ddf41cad6\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "6c8d1682-5caa-4f91-a546-865ddf41cad6" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:03:54Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg1MzIsImlhdCI6MTYzMTgwODIzMiwiYXV0aF90aW1lIjoxNjMxODA4MjMwLCJqdGkiOiI2ZDcyM2FkNy00MjM3LTQ1M2MtODJlZC02OTNjZmM5ZTYxMTciLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjA1ZDlmZGMwLTRjMmQtNDJjZS1hM2ZiLWI2YzAzYjgxYjQxNiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiIwNWQ5ZmRjMC00YzJkLTQyY2UtYTNmYi1iNmMwM2I4MWI0MTYiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.R_9Jc_mzkDg2IaLrQs_haJGlHOASCSxjO0rbZAjxD7cSQC9uqD8fUnZIy6ML9Xdu7kEIpxqq6hzbBtZ7GBtDDEPOp_yWx1Cmgi1Q_1685OMYXBpSh4LXUMgAT58klRP_HAcMm0lWLjYkssmC16W8tLM1RLYsWto6pDu9bo5EyAuwIS5uu2DcCi_jLhMvHCUDk3ptMl_r0qlcAxnmPP-BsqZWXWSTzSPHBtbx3n9bRsGCeCAxi96bpGhCck14h2w26wO-yUXcYRuzfIiv1skX1j_o0b9YFnwvAvJZ5p2lL_CA24W6UbdewgMfhSuGO1LR0HG2UIa7304LV6IIm1fWsw\n", stderr: "" })
[2021-09-16T16:03:55Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:03:55Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:55Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:03:55Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:57Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:57Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:58Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:58Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:59Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:03:59Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:03:59Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0074015bc0, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } }, data: MessageData { topic: "app/6c8d1682-5caa-4f91-a546-865ddf41cad6", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 52, 56, 99, 100, 55, 52, 53, 97, 45, 101, 57, 55, 100, 45, 52, 49, 56, 53, 45, 98, 52, 102, 54, 45, 48, 55, 54, 50, 51, 101, 56, 53, 48, 97, 101, 100, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 54, 99, 56, 100, 49, 54, 56, 50, 37, 50, 68, 53, 99, 97, 97, 37, 50, 68, 52, 102, 57, 49, 37, 50, 68, 97, 53, 52, 54, 37, 50, 68, 56, 54, 53, 100, 100, 102, 52, 49, 99, 97, 100, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 54, 58, 48, 51, 58, 53, 57, 46, 51, 50, 55, 51, 54, 53, 54, 55, 56, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 54, 99, 56, 100, 49, 54, 56, 50, 45, 53, 99, 97, 97, 45, 52, 102, 57, 49, 45, 97, 53, 52, 54, 45, 56, 54, 53, 100, 100, 102, 52, 49, 99, 97, 100, 54, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 54, 99, 56, 100, 49, 54, 56, 50, 37, 50, 68, 53, 99, 97, 97, 37, 50, 68, 52, 102, 57, 49, 37, 50, 68, 97, 53, 52, 54, 37, 50, 68, 56, 54, 53, 100, 100, 102, 52, 49, 99, 97, 100, 54, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 125], props: Properties { cprops: MQTTProperties { count: 0, max_count: 0, length: 0, array: 0x0 } } } }
[2021-09-16T16:03:59Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/6c8d1682-5caa-4f91-a546-865ddf41cad6", content_type: None, user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"48cd745a-e97d-4185-b4f6-07623e850aed\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://6c8d1682%2D5caa%2D4f91%2Da546%2D865ddf41cad6/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T16:03:59.327365678Z\",\"data\":{\"index\":3},\"application\":\"6c8d1682-5caa-4f91-a546-865ddf41cad6\",\"device\":\"device1\",\"partitionkey\":\"6c8d1682%2D5caa%2D4f91%2Da546%2D865ddf41cad6/device1\",\"instance\":\"drogue\"}" }
[2021-09-16T16:04:00Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T16:04:00Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:04:00Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    97,
                    112,
                    112,
                    108,
                    105,
                    99,
                    97,
                    116,
                    105,
                    111,
                    110,
                    61,
                    54,
                    99,
                    56,
                    100,
                    49,
                    54,
                    56,
                    50,
                    45,
                    53,
                    99,
                    97,
                    97,
                    45,
                    52,
                    102,
                    57,
                    49,
                    45,
                    97,
                    53,
                    52,
                    54,
                    45,
                    56,
                    54,
                    53,
                    100,
                    100,
                    102,
                    52,
                    49,
                    99,
                    97,
                    100,
                    54,
                    38,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    79,
                    109,
                    74,
                    104,
                    99,
                    103,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:04:35Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:04:35Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "6c8d1682-5caa-4f91-a546-865ddf41cad6" "device1"
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::resources::apps] Destroy application '6c8d1682-5caa-4f91-a546-865ddf41cad6'
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "6c8d1682-5caa-4f91-a546-865ddf41cad6"
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 6c8d1682-5caa-4f91-a546-865ddf41cad6 deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_only::version_2

**Duration**: 48.740237925s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:04:36Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:04:38Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:04:42Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAwODIsImlhdCI6MTYzMTgwODI4MiwianRpIjoiYTQwNzEwNmItM2FlNi00ZjFlLWE2Y2QtNTFhMjA5YWI1YWFmIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMTVhZGQ0MTAtOWQyMy00Y2U0LTkzNjItOGMxZThkZGJhNWI4Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjE1YWRkNDEwLTlkMjMtNGNlNC05MzYyLThjMWU4ZGRiYTViOCJ9.k2KrXe6LwEYJ5u4PgXE9Z8JXAIi3ZL9T7UlSObnOxlc
[2021-09-16T16:04:42Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:04:42Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:04:42Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAwODIsImlhdCI6MTYzMTgwODI4MiwianRpIjoiYTQwNzEwNmItM2FlNi00ZjFlLWE2Y2QtNTFhMjA5YWI1YWFmIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMTVhZGQ0MTAtOWQyMy00Y2U0LTkzNjItOGMxZThkZGJhNWI4Iiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjE1YWRkNDEwLTlkMjMtNGNlNC05MzYyLThjMWU4ZGRiYTViOCJ9.k2KrXe6LwEYJ5u4PgXE9Z8JXAIi3ZL9T7UlSObnOxlc" "--context" "system-tests"
[2021-09-16T16:04:42Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg1ODIsImlhdCI6MTYzMTgwODI4MiwiYXV0aF90aW1lIjoxNjMxODA4MjgwLCJqdGkiOiI1Zjk3YzYzNy0xNjVjLTQyMjItOGNhYS0xZDNiZmExMmE2ZTUiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjE1YWRkNDEwLTlkMjMtNGNlNC05MzYyLThjMWU4ZGRiYTViOCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiIxNWFkZDQxMC05ZDIzLTRjZTQtOTM2Mi04YzFlOGRkYmE1YjgiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.HeeLZPNU1LvYG1-qz9xF4FPpY4S33UhXjzcpwX4gQ90n1-Y8omteEMdLXgpknqrZtDib2hdHelf6ayrt-ITn9TEiAEYqTBPgEI15BA6xaGkkKFMqRMQWkMLW0hXB41B4oTvJyYkeo7i3fqDJGXPYTsvz7eCdn1LrQWoAbwXszOOLvdFB7N8XixOpvR3X-34Z-9yMVVXjEzDwk-hEldZfVS7Y0CUze8xb7GZINNNTYZd10nq71b9-68jc2ZecXIYfkRFW8j-DMxZ9zbmzhHMHtlijVjNaN3rea6K2xcQ9mJzoFGzXm6-AZ-pgWG4x3UUoHRGlQ7Wh5Q0kzGTUzNEJlQ\n", stderr: "" })
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::resources::apps] Create application: 8c81cd10-7ec8-485a-99d7-19097906b4fe
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "8c81cd10-7ec8-485a-99d7-19097906b4fe"
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 8c81cd10-7ec8-485a-99d7-19097906b4fe created.\n", stderr: "" })
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "8c81cd10-7ec8-485a-99d7-19097906b4fe"
[2021-09-16T16:04:43Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:04:43.282521Z\",\n    \"generation\": 1,\n    \"name\": \"8c81cd10-7ec8-485a-99d7-19097906b4fe\",\n    \"resourceVersion\": \"42114b80-0691-4b9e-a3ef-39f2eb5c25c3\",\n    \"uid\": \"e1ef60a4-a559-4cc7-81f3-f08d270f197a\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:04:43.306234881Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      }\n    ]\n  }\n}", stderr: "" })
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "8c81cd10-7ec8-485a-99d7-19097906b4fe"
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:04:43.282521Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"8c81cd10-7ec8-485a-99d7-19097906b4fe\",\n    \"resourceVersion\": \"298a803b-20d3-4b94-9828-ed96258bceea\",\n    \"uid\": \"e1ef60a4-a559-4cc7-81f3-f08d270f197a\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:04:43.643391351Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:04:43.643177338Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.351598532Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.360119272Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.450769027Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.459720880Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.643147282Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.643149526Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"pOb7qzEhhXoT\",\n        \"username\": \"user-8c81cd10-7ec8-485a-99d7-19097906b4fe\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "8c81cd10-7ec8-485a-99d7-19097906b4fe"
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:04:43.282521Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"8c81cd10-7ec8-485a-99d7-19097906b4fe\",\n    \"resourceVersion\": \"298a803b-20d3-4b94-9828-ed96258bceea\",\n    \"uid\": \"e1ef60a4-a559-4cc7-81f3-f08d270f197a\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:04:43.643391351Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:04:43.643177338Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.351598532Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.360119272Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.450769027Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.459720880Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.643147282Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:04:43.643149526Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"pOb7qzEhhXoT\",\n        \"username\": \"user-8c81cd10-7ec8-485a-99d7-19097906b4fe\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "8c81cd10-7ec8-485a-99d7-19097906b4fe" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg1ODIsImlhdCI6MTYzMTgwODI4MiwiYXV0aF90aW1lIjoxNjMxODA4MjgwLCJqdGkiOiI1Zjk3YzYzNy0xNjVjLTQyMjItOGNhYS0xZDNiZmExMmE2ZTUiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjE1YWRkNDEwLTlkMjMtNGNlNC05MzYyLThjMWU4ZGRiYTViOCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiIxNWFkZDQxMC05ZDIzLTRjZTQtOTM2Mi04YzFlOGRkYmE1YjgiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.HeeLZPNU1LvYG1-qz9xF4FPpY4S33UhXjzcpwX4gQ90n1-Y8omteEMdLXgpknqrZtDib2hdHelf6ayrt-ITn9TEiAEYqTBPgEI15BA6xaGkkKFMqRMQWkMLW0hXB41B4oTvJyYkeo7i3fqDJGXPYTsvz7eCdn1LrQWoAbwXszOOLvdFB7N8XixOpvR3X-34Z-9yMVVXjEzDwk-hEldZfVS7Y0CUze8xb7GZINNNTYZd10nq71b9-68jc2ZecXIYfkRFW8j-DMxZ9zbmzhHMHtlijVjNaN3rea6K2xcQ9mJzoFGzXm6-AZ-pgWG4x3UUoHRGlQ7Wh5Q0kzGTUzNEJlQ\n", stderr: "" })
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:04:44Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:04:46Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:04:46Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:04:47Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:04:47Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:04:48Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:04:48Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:04:48Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 443, payload: 0x7f0080016c00, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } }, data: MessageData { topic: "app/8c81cd10-7ec8-485a-99d7-19097906b4fe", payload: [123, 34, 115, 112, 101, 99, 118, 101, 114, 115, 105, 111, 110, 34, 58, 34, 49, 46, 48, 34, 44, 34, 105, 100, 34, 58, 34, 54, 51, 56, 99, 55, 99, 101, 57, 45, 49, 51, 102, 53, 45, 52, 101, 97, 56, 45, 56, 99, 99, 50, 45, 52, 97, 57, 99, 49, 97, 55, 55, 56, 51, 97, 49, 34, 44, 34, 116, 121, 112, 101, 34, 58, 34, 105, 111, 46, 100, 114, 111, 103, 117, 101, 46, 101, 118, 101, 110, 116, 46, 118, 49, 34, 44, 34, 115, 111, 117, 114, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 58, 47, 47, 56, 99, 56, 49, 99, 100, 49, 48, 37, 50, 68, 55, 101, 99, 56, 37, 50, 68, 52, 56, 53, 97, 37, 50, 68, 57, 57, 100, 55, 37, 50, 68, 49, 57, 48, 57, 55, 57, 48, 54, 98, 52, 102, 101, 47, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 100, 97, 116, 97, 99, 111, 110, 116, 101, 110, 116, 116, 121, 112, 101, 34, 58, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110, 34, 44, 34, 115, 117, 98, 106, 101, 99, 116, 34, 58, 34, 119, 97, 114, 109, 117, 112, 34, 44, 34, 116, 105, 109, 101, 34, 58, 34, 50, 48, 50, 49, 45, 48, 57, 45, 49, 54, 84, 49, 54, 58, 48, 52, 58, 52, 56, 46, 51, 51, 55, 52, 53, 57, 53, 53, 49, 90, 34, 44, 34, 100, 97, 116, 97, 34, 58, 123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125, 44, 34, 97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 34, 58, 34, 56, 99, 56, 49, 99, 100, 49, 48, 45, 55, 101, 99, 56, 45, 52, 56, 53, 97, 45, 57, 57, 100, 55, 45, 49, 57, 48, 57, 55, 57, 48, 54, 98, 52, 102, 101, 34, 44, 34, 105, 110, 115, 116, 97, 110, 99, 101, 34, 58, 34, 100, 114, 111, 103, 117, 101, 34, 44, 34, 100, 101, 118, 105, 99, 101, 34, 58, 34, 100, 101, 118, 105, 99, 101, 49, 34, 44, 34, 112, 97, 114, 116, 105, 116, 105, 111, 110, 107, 101, 121, 34, 58, 34, 56, 99, 56, 49, 99, 100, 49, 48, 37, 50, 68, 55, 101, 99, 56, 37, 50, 68, 52, 56, 53, 97, 37, 50, 68, 57, 57, 100, 55, 37, 50, 68, 49, 57, 48, 57, 55, 57, 48, 54, 98, 52, 102, 101, 47, 100, 101, 118, 105, 99, 101, 49, 34, 125], props: Properties { cprops: MQTTProperties { count: 2, max_count: 10, length: 48, array: 0x7f0080016dd0 } } } }
[2021-09-16T16:04:48Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/8c81cd10-7ec8-485a-99d7-19097906b4fe", content_type: Some("application/cloudevents+json; charset=utf-8"), user_properties: {}, payload: "{\"specversion\":\"1.0\",\"id\":\"638c7ce9-13f5-4ea8-8cc2-4a9c1a7783a1\",\"type\":\"io.drogue.event.v1\",\"source\":\"drogue://8c81cd10%2D7ec8%2D485a%2D99d7%2D19097906b4fe/device1\",\"datacontenttype\":\"application/json\",\"subject\":\"warmup\",\"time\":\"2021-09-16T16:04:48.337459551Z\",\"data\":{\"index\":3},\"application\":\"8c81cd10-7ec8-485a-99d7-19097906b4fe\",\"instance\":\"drogue\",\"device\":\"device1\",\"partitionkey\":\"8c81cd10%2D7ec8%2D485a%2D99d7%2D19097906b4fe/device1\"}" }
[2021-09-16T16:04:49Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T16:04:49Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:04:49Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                    38,
                    97,
                    112,
                    112,
                    108,
                    105,
                    99,
                    97,
                    116,
                    105,
                    111,
                    110,
                    61,
                    56,
                    99,
                    56,
                    49,
                    99,
                    100,
                    49,
                    48,
                    45,
                    55,
                    101,
                    99,
                    56,
                    45,
                    52,
                    56,
                    53,
                    97,
                    45,
                    57,
                    57,
                    100,
                    55,
                    45,
                    49,
                    57,
                    48,
                    57,
                    55,
                    57,
                    48,
                    54,
                    98,
                    52,
                    102,
                    101,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    79,
                    109,
                    74,
                    104,
                    99,
                    103,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:05:24Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:05:24Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "8c81cd10-7ec8-485a-99d7-19097906b4fe" "device1"
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::resources::apps] Destroy application '8c81cd10-7ec8-485a-99d7-19097906b4fe'
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "8c81cd10-7ec8-485a-99d7-19097906b4fe"
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 8c81cd10-7ec8-485a-99d7-19097906b4fe deleted.\n", stderr: "" })

</pre>

</details>

## ❌ tests::coap::telemetry::test_send_telemetry_user_only::version_3

**Duration**: 49.053485973s

<details>

<summary>Test output</summary>

<pre>
-------------- TEST START --------------
[2021-09-16T16:05:25Z INFO  drogue_cloud_tests::tests::coap] entered coap_to_mqtt!
[2021-09-16T16:05:27Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:05:30Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAxMzAsImlhdCI6MTYzMTgwODMzMCwianRpIjoiZWM5ODU0Y2MtMzU3Yy00ODdkLWEzNmQtNGIxNGNhMmU1OWQyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOGVkNjc2YzItODI5ZS00YWYyLTg5MGQtOWNjOWEyNjU1OWNiIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjhlZDY3NmMyLTgyOWUtNGFmMi04OTBkLTljYzlhMjY1NTljYiJ9.puRkv-jLq4jZuWBfiIlc2ZYn5xH0bSVT7RvB6tledWg
[2021-09-16T16:05:30Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:05:30Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:05:30Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTAxMzAsImlhdCI6MTYzMTgwODMzMCwianRpIjoiZWM5ODU0Y2MtMzU3Yy00ODdkLWEzNmQtNGIxNGNhMmU1OWQyIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiOGVkNjc2YzItODI5ZS00YWYyLTg5MGQtOWNjOWEyNjU1OWNiIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjhlZDY3NmMyLTgyOWUtNGFmMi04OTBkLTljYzlhMjY1NTljYiJ9.puRkv-jLq4jZuWBfiIlc2ZYn5xH0bSVT7RvB6tledWg" "--context" "system-tests"
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg2MzEsImlhdCI6MTYzMTgwODMzMSwiYXV0aF90aW1lIjoxNjMxODA4MzI4LCJqdGkiOiI0MjJlYmFhNy1hZDY1LTQ5ZjItOTMzMi0xNzlhMzM3ZDYxYWEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjhlZDY3NmMyLTgyOWUtNGFmMi04OTBkLTljYzlhMjY1NTljYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI4ZWQ2NzZjMi04MjllLTRhZjItODkwZC05Y2M5YTI2NTU5Y2IiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.FSUP3LkKgHSZp5YxXkF7XIm3y3g3TmkKGQ5dLW-cjYUF0Pw5aTji31p4XIBAXowapB9aRl2ZJYQuOFjDA7WtvYVldN2IQipBKVvr-sMU-22MfoA_wA1XPihBxR2x6J0TxN5ztIpfeFU5zCtygv0SVq6KLCKhKXSaGKRVrAYMHANicrPqXh9EKgQ_Y4Zpx_Wm0-R7MhuHG46sFiebwbi_qBueTEdKJrVm4JXBJFCnZ0RCzNs8fWNoIN23sGib5RhKkTu_7TMaK47zw9FY1hYBlQipsb_KNEVjbZFD8BjtCgFP2QpV4h4NM1rVcL3mm-JMmXO-VD2mwVUMsSm9nFPMxw\n", stderr: "" })
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::resources::apps] Create application: 68eb541d-96db-45f1-90e3-431a569e16fe
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "68eb541d-96db-45f1-90e3-431a569e16fe"
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 68eb541d-96db-45f1-90e3-431a569e16fe created.\n", stderr: "" })
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "68eb541d-96db-45f1-90e3-431a569e16fe"
[2021-09-16T16:05:31Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:05:31.785801Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 2,\n    \"name\": \"68eb541d-96db-45f1-90e3-431a569e16fe\",\n    \"resourceVersion\": \"a0b3a448-a9d6-494f-ad6d-7d2231702453\",\n    \"uid\": \"dcaa9d84-e979-4ce0-9bf6-4f7de2b51a71\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:31.805435650Z\",\n        \"reason\": \"NonReadyConditions\",\n        \"status\": \"False\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:31.805425571Z\",\n        \"message\": \"Waiting to become ready: HasFinalizer\",\n        \"reason\": \"WaitingForReady\",\n        \"status\": \"False\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805408669Z\",\n          \"status\": \"False\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805409381Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805409691Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805410052Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805410352Z\",\n          \"status\": \"Unknown\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.805411525Z\",\n          \"reason\": \"Progressing\",\n          \"status\": \"False\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 1\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "68eb541d-96db-45f1-90e3-431a569e16fe"
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:05:31.785801Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"68eb541d-96db-45f1-90e3-431a569e16fe\",\n    \"resourceVersion\": \"051fabd2-2392-48ef-bdd8-c96936ca3d65\",\n    \"uid\": \"dcaa9d84-e979-4ce0-9bf6-4f7de2b51a71\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:32.138444863Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:32.138409646Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.833616764Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.842990606Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.933437481Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.940893150Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:32.138381293Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:32.138383156Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"CFo5qqg8XmAu\",\n        \"username\": \"user-68eb541d-96db-45f1-90e3-431a569e16fe\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "68eb541d-96db-45f1-90e3-431a569e16fe"
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:05:31.785801Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"68eb541d-96db-45f1-90e3-431a569e16fe\",\n    \"resourceVersion\": \"051fabd2-2392-48ef-bdd8-c96936ca3d65\",\n    \"uid\": \"dcaa9d84-e979-4ce0-9bf6-4f7de2b51a71\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:32.138444863Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:05:32.138409646Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.833616764Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.842990606Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.933437481Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:31.940893150Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:32.138381293Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:05:32.138383156Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"CFo5qqg8XmAu\",\n        \"username\": \"user-68eb541d-96db-45f1-90e3-431a569e16fe\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::resources::devices] Create device: device1
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "device" "--app" "68eb541d-96db-45f1-90e3-431a569e16fe" "device1" "--spec" "{\"credentials\":{\"credentials\":[{\"user\":{\"password\":\"bar\",\"username\":\"foo\"}}]}}"
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 created.\n", stderr: "" })
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::tests::coap] MQTT integration URL: ssl://mqtt-integration.172.18.0.2.nip.io:30002
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "whoami" "-t"
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQeUIwSXNvRk1XM2lGVDh3c3ZiaFZ1amp6VGRIMkdkRENGNzh2aXluRzRjIn0.eyJleHAiOjE2MzE4MDg2MzEsImlhdCI6MTYzMTgwODMzMSwiYXV0aF90aW1lIjoxNjMxODA4MzI4LCJqdGkiOiI0MjJlYmFhNy1hZDY1LTQ5ZjItOTMzMi0xNzlhMzM3ZDYxYWEiLCJpc3MiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsImF1ZCI6WyJkcm9ndWUiLCJyZWFsbS1tYW5hZ2VtZW50IiwiZ3JhZmFuYSIsImFjY291bnQiXSwic3ViIjoiMTIxMGYzYWMtNzZjMi00ZDI0LWJjODAtYWEwMWE3MjQ3MzcwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZHJvZ3VlIiwic2Vzc2lvbl9zdGF0ZSI6IjhlZDY3NmMyLTgyOWUtNGFmMi04OTBkLTljYzlhMjY1NTljYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2NvbnNvbGUuMTcyLjE4LjAuMi5uaXAuaW8iLCJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRyb2d1ZS11c2VyIiwiZHJvZ3VlLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiXX0sInJlc291cmNlX2FjY2VzcyI6eyJyZWFsbS1tYW5hZ2VtZW50Ijp7InJvbGVzIjpbIm1hbmFnZS11c2VycyJdfSwiZ3JhZmFuYSI6eyJyb2xlcyI6WyJncmFmYW5hLWVkaXRvciIsImdyYWZhbmEtYWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI4ZWQ2NzZjMi04MjllLTRhZjItODkwZC05Y2M5YTI2NTU5Y2IiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJTeXN0ZW0gQWRtaW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJTeXN0ZW0iLCJmYW1pbHlfbmFtZSI6IkFkbWluIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.FSUP3LkKgHSZp5YxXkF7XIm3y3g3TmkKGQ5dLW-cjYUF0Pw5aTji31p4XIBAXowapB9aRl2ZJYQuOFjDA7WtvYVldN2IQipBKVvr-sMU-22MfoA_wA1XPihBxR2x6J0TxN5ztIpfeFU5zCtygv0SVq6KLCKhKXSaGKRVrAYMHANicrPqXh9EKgQ_Y4Zpx_Wm0-R7MhuHG46sFiebwbi_qBueTEdKJrVm4JXBJFCnZ0RCzNs8fWNoIN23sGib5RhKkTu_7TMaK47zw9FY1hYBlQipsb_KNEVjbZFD8BjtCgFP2QpV4h4NM1rVcL3mm-JMmXO-VD2mwVUMsSm9nFPMxw\n", stderr: "" })
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::tests::coap] Receiver created
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Starting message stream...
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:05:32Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:05:34Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:05:34Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:05:35Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:05:35Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:05:36Z INFO  drogue_cloud_tests::context] Adding root certificate
[2021-09-16T16:05:36Z INFO  drogue_cloud_tests::tools::http] Sending payload
[2021-09-16T16:05:36Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Raw message: Message { cmsg: MQTTAsync_message { struct_id: [77, 81, 84, 77], struct_version: 1, payloadlen: 11, payload: 0x7f0074016050, qos: 0, retained: 0, dup: 0, msgid: 0, properties: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432e4110 } }, data: MessageData { topic: "app/68eb541d-96db-45f1-90e3-431a569e16fe", payload: [123, 34, 105, 110, 100, 101, 120, 34, 58, 51, 125], props: Properties { cprops: MQTTProperties { count: 11, max_count: 20, length: 400, array: 0x5638432e4110 } } } }
[2021-09-16T16:05:36Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received: MqttMessage { topic: "app/68eb541d-96db-45f1-90e3-431a569e16fe", content_type: Some("application/json"), user_properties: {"id": "fb3bcad2-8f9d-4562-a823-8b8b9f763d26", "device": "device1", "subject": "warmup", "time": "2021-09-16T16:05:36.357895102+00:00", "partitionkey": "68eb541d%2D96db%2D45f1%2D90e3%2D431a569e16fe/device1", "instance": "drogue", "source": "drogue://68eb541d%2D96db%2D45f1%2D90e3%2D431a569e16fe/device1", "specversion": "1.0", "application": "68eb541d-96db-45f1-90e3-431a569e16fe", "type": "io.drogue.event.v1"}, payload: "{\"index\":3}" }
[2021-09-16T16:05:37Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received first message after 3 attempts
[2021-09-16T16:05:37Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Received most recent messages ... warmed up!
[2021-09-16T16:05:37Z INFO  drogue_cloud_tests::tests::coap] Sending payload
Client request: coap://coap-endpoint.172.18.0.2.nip.io:30003
CoapRequest {
    message: Packet {
        header: Header {
            ver_type_tkl: 64,
            code: Request(
                Get,
            ),
            message_id: 0,
        },
        token: [],
        options: {
            11: [
                [
                    118,
                    49,
                ],
                [
                    116,
                    101,
                    108,
                    101,
                    109,
                    101,
                    116,
                    114,
                    121,
                ],
            ],
            15: [
                [
                    97,
                    112,
                    112,
                    108,
                    105,
                    99,
                    97,
                    116,
                    105,
                    111,
                    110,
                    61,
                    54,
                    56,
                    101,
                    98,
                    53,
                    52,
                    49,
                    100,
                    45,
                    57,
                    54,
                    100,
                    98,
                    45,
                    52,
                    53,
                    102,
                    49,
                    45,
                    57,
                    48,
                    101,
                    51,
                    45,
                    52,
                    51,
                    49,
                    97,
                    53,
                    54,
                    57,
                    101,
                    49,
                    54,
                    102,
                    101,
                    38,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    61,
                    100,
                    101,
                    118,
                    105,
                    99,
                    101,
                    49,
                ],
            ],
            4209: [
                [
                    66,
                    97,
                    115,
                    105,
                    99,
                    32,
                    90,
                    109,
                    57,
                    118,
                    79,
                    109,
                    74,
                    104,
                    99,
                    103,
                ],
            ],
        },
        payload: [],
    },
    response: None,
    source: None,
}
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 11, kind: WouldBlock, message: "Resource temporarily unavailable" }', src/tools/coap/mod.rs:32:75
[2021-09-16T16:06:13Z INFO  drogue_cloud_tests::tools::mqtt::receiver] Dropping MQTT receiver
[2021-09-16T16:06:13Z ERROR paho_mqtt::async_client] Stream error: TrySendError { kind: Disconnected }
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::resources::devices] Destroy application 'device1'
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "device" "--app" "68eb541d-96db-45f1-90e3-431a569e16fe" "device1"
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "Device device1 deleted.\n", stderr: "" })
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::resources::apps] Destroy application '68eb541d-96db-45f1-90e3-431a569e16fe'
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "68eb541d-96db-45f1-90e3-431a569e16fe"
[2021-09-16T16:06:14Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 68eb541d-96db-45f1-90e3-431a569e16fe deleted.\n", stderr: "" })

</pre>

</details>

## ✅ tests::drg::test_drg_version

**Duration**: 7.65782687s

## ✅ tests::http::command::test_command::version_1

**Duration**: 15.765888365s

## ✅ tests::http::command::test_command::version_2

**Duration**: 14.080653883s

## ✅ tests::http::command::test_command::version_3

**Duration**: 15.018258174s

## ✅ tests::http::telemetry::test_send_telemetry_pass::version_1

**Duration**: 14.227111479s

## ✅ tests::http::telemetry::test_send_telemetry_pass::version_2

**Duration**: 14.670344829s

## ✅ tests::http::telemetry::test_send_telemetry_pass::version_3

**Duration**: 13.233156176s

## ✅ tests::http::telemetry::test_send_telemetry_user::version_1

**Duration**: 13.761483042s

## ✅ tests::http::telemetry::test_send_telemetry_user::version_2

**Duration**: 15.148632247s

## ✅ tests::http::telemetry::test_send_telemetry_user::version_3

**Duration**: 13.883565511s

## ✅ tests::http::telemetry::test_send_telemetry_user_alias::version_1

**Duration**: 15.149462025s

## ✅ tests::http::telemetry::test_send_telemetry_user_alias::version_2

**Duration**: 13.968707673s

## ✅ tests::http::telemetry::test_send_telemetry_user_alias::version_3

**Duration**: 13.050530705s

## ✅ tests::http::telemetry::test_send_telemetry_user_only::version_1

**Duration**: 13.987304678s

## ✅ tests::http::telemetry::test_send_telemetry_user_only::version_2

**Duration**: 14.983486302s

## ✅ tests::http::telemetry::test_send_telemetry_user_only::version_3

**Duration**: 13.904948245s

## ✅ tests::mqtt::command::test_command::version_1

**Duration**: 9.495746283s

## ✅ tests::mqtt::command::test_command::version_2

**Duration**: 9.306200889s

## ✅ tests::mqtt::command::test_command::version_3

**Duration**: 8.503660664s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_1

**Duration**: 15.456891997s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_2

**Duration**: 15.98472069s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_1::integration_version_3

**Duration**: 15.044858559s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_1

**Duration**: 15.193079643s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_2

**Duration**: 15.034567951s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_2::integration_version_3

**Duration**: 15.016176911s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_1

**Duration**: 13.995606868s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_2

**Duration**: 15.114995059s

## ✅ tests::mqtt::telemetry::test_send_telemetry_pass::endpoint_version_3::integration_version_3

**Duration**: 14.94636917s

## ❌ tests::registry::test_registry_create_and_delete

**Duration**: 9.157882722s

<details>

<summary>Test output</summary>

<pre>
[2021-09-16T16:12:42Z INFO  drogue_cloud_tests::init::drg] Endpoints: Object({
        "api": String(
            "http://api.172.18.0.2.nip.io",
        ),
        "console": String(
            "http://console.172.18.0.2.nip.io",
        ),
        "issuer_url": String(
            "http://sso.172.18.0.2.nip.io/auth/realms/drogue",
        ),
        "registry": Object({
            "url": String(
                "http://api.172.18.0.2.nip.io",
            ),
        }),
        "sso": String(
            "http://sso.172.18.0.2.nip.io",
        ),
    })
[2021-09-16T16:12:46Z INFO  drogue_cloud_tests::init::drg] Refresh token: eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTA1NjYsImlhdCI6MTYzMTgwODc2NiwianRpIjoiZGZlNGRjNDUtYmZhMC00YWYwLTg5NWQtNDhmMjdjZmJhNjZhIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMmNkOTA3YjEtZWJjYi00MzA4LWFmODItNTRjNGY3MGZjZmExIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjJjZDkwN2IxLWViY2ItNDMwOC1hZjgyLTU0YzRmNzBmY2ZhMSJ9.i2l8bHjW8r-IB_7i68hn60EhYzEqJVdFlLWJ5ekJQOM
[2021-09-16T16:12:46Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "context" "delete" "system-tests"
[2021-09-16T16:12:46Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "", stderr: "" })
[2021-09-16T16:12:46Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "login" "http://api.172.18.0.2.nip.io/" "-t" "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwZjNlZWNlMS1mNTZhLTQxNDMtOGZiYy0xOWM5ZTBkNmYxNzYifQ.eyJleHAiOjE2MzE4MTA1NjYsImlhdCI6MTYzMTgwODc2NiwianRpIjoiZGZlNGRjNDUtYmZhMC00YWYwLTg5NWQtNDhmMjdjZmJhNjZhIiwiaXNzIjoiaHR0cDovL3Nzby4xNzIuMTguMC4yLm5pcC5pby9hdXRoL3JlYWxtcy9kcm9ndWUiLCJhdWQiOiJodHRwOi8vc3NvLjE3Mi4xOC4wLjIubmlwLmlvL2F1dGgvcmVhbG1zL2Ryb2d1ZSIsInN1YiI6IjEyMTBmM2FjLTc2YzItNGQyNC1iYzgwLWFhMDFhNzI0NzM3MCIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJkcm9ndWUiLCJzZXNzaW9uX3N0YXRlIjoiMmNkOTA3YjEtZWJjYi00MzA4LWFmODItNTRjNGY3MGZjZmExIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNpZCI6IjJjZDkwN2IxLWViY2ItNDMwOC1hZjgyLTU0YzRmNzBmY2ZhMSJ9.i2l8bHjW8r-IB_7i68hn60EhYzEqJVdFlLWJ5ekJQOM" "--context" "system-tests"
[2021-09-16T16:12:46Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "\nSuccessfully authenticated to drogue cloud : http://api.172.18.0.2.nip.io/\nSwitched active context to: system-tests\n", stderr: "" })
[2021-09-16T16:12:47Z INFO  drogue_cloud_tests::resources::apps] Create application: 76e5f2de-b9ce-40c6-8826-2b489a087ea9
[2021-09-16T16:12:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "create" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:47Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 76e5f2de-b9ce-40c6-8826-2b489a087ea9 created.\n", stderr: "" })
[2021-09-16T16:12:47Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:47Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:12:47.702423Z\",\n    \"generation\": 0,\n    \"name\": \"76e5f2de-b9ce-40c6-8826-2b489a087ea9\",\n    \"resourceVersion\": \"dfe9939c-dd9e-48d3-9b44-e7c3f1620b48\",\n    \"uid\": \"0bf400b9-3881-4ed9-a01a-b57b73b6f9e5\"\n  }\n}", stderr: "" })
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:12:47.702423Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"76e5f2de-b9ce-40c6-8826-2b489a087ea9\",\n    \"resourceVersion\": \"6643fb38-fe5d-4fe0-af41-db51927dcfe5\",\n    \"uid\": \"0bf400b9-3881-4ed9-a01a-b57b73b6f9e5\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:12:48.285980762Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:12:48.285928924Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.797868214Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.805111837Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.954447095Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.972854483Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:48.285897575Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:48.285899930Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"otcx9FGTUucM\",\n        \"username\": \"user-76e5f2de-b9ce-40c6-8826-2b489a087ea9\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "get" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "{\n  \"metadata\": {\n    \"creationTimestamp\": \"2021-09-16T16:12:47.702423Z\",\n    \"finalizers\": [\n      \"kafka\"\n    ],\n    \"generation\": 9,\n    \"name\": \"76e5f2de-b9ce-40c6-8826-2b489a087ea9\",\n    \"resourceVersion\": \"6643fb38-fe5d-4fe0-af41-db51927dcfe5\",\n    \"uid\": \"0bf400b9-3881-4ed9-a01a-b57b73b6f9e5\"\n  },\n  \"status\": {\n    \"conditions\": [\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:12:48.285980762Z\",\n        \"status\": \"True\",\n        \"type\": \"Ready\"\n      },\n      {\n        \"lastTransitionTime\": \"2021-09-16T16:12:48.285928924Z\",\n        \"status\": \"True\",\n        \"type\": \"KafkaReady\"\n      }\n    ],\n    \"kafka\": {\n      \"conditions\": [\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.797868214Z\",\n          \"status\": \"True\",\n          \"type\": \"HasFinalizer\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.805111837Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateTopics\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.954447095Z\",\n          \"status\": \"True\",\n          \"type\": \"TopicsReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:47.972854483Z\",\n          \"status\": \"True\",\n          \"type\": \"CreateUser\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:48.285897575Z\",\n          \"status\": \"True\",\n          \"type\": \"UserReady\"\n        },\n        {\n          \"lastTransitionTime\": \"2021-09-16T16:12:48.285899930Z\",\n          \"reason\": \"AsExpected\",\n          \"status\": \"True\",\n          \"type\": \"Reconciled\"\n        }\n      ],\n      \"observedGeneration\": 8,\n      \"user\": {\n        \"mechanism\": \"SCRAM-SHA-512\",\n        \"password\": \"otcx9FGTUucM\",\n        \"username\": \"user-76e5f2de-b9ce-40c6-8826-2b489a087ea9\"\n      }\n    }\n  }\n}", stderr: "" })
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 76e5f2de-b9ce-40c6-8826-2b489a087ea9 deleted.\n", stderr: "" })
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 76e5f2de-b9ce-40c6-8826-2b489a087ea9 deleted.\n", stderr: "" })
thread 'main' panicked at 'assertion failed: r.is_err()', src/tests/registry/mod.rs:53:5
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::resources::apps] Destroy application '76e5f2de-b9ce-40c6-8826-2b489a087ea9'
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Running: "drg" "delete" "app" "76e5f2de-b9ce-40c6-8826-2b489a087ea9"
[2021-09-16T16:12:48Z INFO  drogue_cloud_tests::init::drg] Output: Ok(Output { status: ExitStatus(ExitStatus(0)), stdout: "App 76e5f2de-b9ce-40c6-8826-2b489a087ea9 deleted.\n", stderr: "" })

</pre>

</details>

## ✅ tests::registry::test_registry_create_app

**Duration**: 9.070406528s

## ✅ tests::registry::test_registry_create_app_and_device

**Duration**: 10.336797239s

## ✅ tests::registry::test_registry_create_app_and_device_twice

**Duration**: 9.148875362s

## ✅ tests::registry::test_registry_create_app_twice

**Duration**: 9.383276868s

## ✅ tests::registry::test_registry_device_create_and_delete

**Duration**: 8.909697586s
